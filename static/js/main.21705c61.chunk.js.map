{"version":3,"sources":["features/settingSlices.ts","utils/storage.ts","components/commons/Popover.tsx","features/peerSlices.ts","components/NavBar/PeerListItem.tsx","hooks/usePeer.ts","components/NavBar/PeerList.tsx","components/NavBar/PeerGroup.tsx","components/commons/Dialog.tsx","components/commons/Fade.tsx","features/docSlices.ts","components/NavBar/ShareButton.tsx","components/NavBar/NetworkButton.tsx","features/navSlices.ts","components/NavBar/index.tsx","features/linkSlices.ts","components/Editor/CodeEditor/Cursor.ts","components/Editor/CodeEditor/slideView.ts","components/Editor/CodeEditor/codemirror/shuffle.ts","components/Editor/CodeEditor/index.tsx","features/boardSlices.ts","utils/eventDispatcher.ts","components/Editor/DrawingBoard/Canvas/CanvasWrapper.ts","components/Editor/DrawingBoard/Canvas/line.ts","components/Editor/DrawingBoard/Canvas/utils.ts","components/Editor/DrawingBoard/Canvas/rect.ts","components/Editor/DrawingBoard/Canvas/dom.ts","components/Editor/DrawingBoard/Canvas/scheduler.ts","components/Editor/DrawingBoard/Canvas/Worker/Worker.ts","components/Editor/DrawingBoard/Canvas/Worker/LineWorker.ts","components/Editor/DrawingBoard/Canvas/Worker/RectWorker.ts","components/Editor/DrawingBoard/Canvas/Board.ts","components/Editor/DrawingBoard/Canvas/Worker/EraserWorker.ts","components/Editor/DrawingBoard/Canvas/Worker/SelectorWorker.ts","components/Editor/DrawingBoard/Canvas/Worker/NoneWorker.ts","components/Editor/DrawingBoard/index.tsx","assets/icons/Eraser.tsx","assets/icons/Mouse.tsx","assets/icons/Rect.tsx","components/Editor/Sidebar/Settings.tsx","components/Editor/Sidebar/ButtonWithColor.tsx","components/Editor/Sidebar/index.tsx","components/Editor/Editor.tsx","components/Editor/index.tsx","features/messageSlices.ts","components/SideBar/index.tsx","pages/DocPage.tsx","app/App.tsx","app/rootReducer.ts","app/store.ts","serviceWorker.ts","index.tsx"],"names":["Theme","CodeKeyMap","TabSize","BrowserStorage","key","storage","this","window","localStorage","initial","JSON","parse","value","stringify","SettingModel","prefersDark","matchMedia","matches","initialState","getValue","menu","theme","Dark","Light","codeKeyMap","Sublime","tabSize","Two","userName","userColor","settingSlice","createSlice","name","reducers","setDarkMode","state","action","payload","setValue","setCodeKeyMap","setTabSize","setUserName","setUserColor","actions","Popover","anchorEl","onClose","children","anchorOrigin","transformOrigin","isOpen","Boolean","id","undefined","open","defaultProps","vertical","horizontal","ConnectionStatus","useStyles","makeStyles","root","props","color","peer","presence","PeerListItem","classes","ListItem","className","username","peerSlice","peers","syncPeer","myClientID","changedPeers","Object","keys","clientID","status","Disconnected","entries","Connected","isMine","updatePresenceColor","createAsyncThunk","newColor","thunkApi","client","getState","docState","updatePresence","err","rejectWithValue","message","usePeer","useSelector","peerState","activePeers","useMemo","values","filter","PeerList","List","Typography","length","map","group","cursor","myAvatar","borderColor","palette","secondary","main","content","position","top","left","width","height","borderRadius","border","PeerGroup","useState","setAnchorEl","handleViewList","useCallback","event","target","getAttribute","currentTarget","handleViewListClose","AvatarGroup","max","onClick","image","Tooltip","title","arrow","Avatar","alt","style","backgroundColor","src","anonymous","getImage","DialogTitle","withStyles","createStyles","margin","padding","spacing","closeButton","right","grey","other","disableTypography","variant","IconButton","DialogContent","MuiDialogContent","DialogActions","MuiDialogActions","Dialog","maxWidth","Fade","timeout","show","onFadeout","timeoutId","useRef","useEffect","current","setTimeout","clearTimeout","in","Preview","CodeMode","DocStatus","mode","Markdown","preview","HTML","loading","errorMessage","Connect","headings","generateTableOfContents","editorInstance","count","Number","MAX_SAFE_INTEGER","doc","getDoc","lineCount","i","line","getLine","tokens","getTokenTypeAt","ch","includes","match","level","text","push","originalText","getTableOfContents","cm","document","querySelector","CodeMirror","activateClient","_","a","generate","animal","settingState","options","apiKey","randomColor","board","process","yorkie","Client","activate","attachDoc","attach","update","Text","shapes","sync","docSlice","deactivateClient","deactivate","createDocument","Document","detachDocument","detach","attachDocLoading","setCodeMode","setPreview","setStatus","updateHeadings","it","index","type","encodeURIComponent","fileLink","location","pathname","linkType","extraReducers","builder","addCase","fulfilled","rejected","dialog","input","fontSize","outline","box","display","justifyContent","alignItems","button","lineHeight","ShareButton","setOpen","showCopyText","setShowCopyText","inputRef","copyUrl","href","split","onFocus","select","onCopy","openModal","closeModal","Button","size","startIcon","disabled","Disconnect","dividers","Box","my","DialogContentText","readOnly","ref","marginTop","autoFocus","fontWeight","NetworkAlert","subTitle","px","py","p","pb","NetworkDisconnect","hasLocalChanges","handleOpen","handleClose","NetworkConnect","NetworkButton","navSlice","openTab","openTabValue","toggleTab","toggleLinkTab","flexGrow","appBar","iconButton","marginRight","grow","primary","textDecoration","items","MenuAppBar","dispatch","useDispatch","AppBar","Toolbar","Link","underline","rel","memo","traverse","parent","data","callback","depth","forEach","item","links","findOne","result","initialLinkState","favorite","groups","Date","now","opens","startsWith","linkSlice","refreshStorage","newValue","toggleFavorite","some","toggleLinkOpen","removeLink","link","removeGroup","setLinkOpens","setLinkName","foundItem","updateLinkNameWithHeading","heading","currentLink","setLinkFileLink","newGroup","newGroupAt","newGroups","newChildGroupAt","foundGroupItem","parentId","newLink","temp","Math","random","toString","substring","newLinkByCurrentPage","copyMarkdownTextForGroup","list","navigator","clipboard","writeText","copyTextToClipboard","prefix","repeat","join","favoriteSelector","linkState","CursorStatus","Cursor","marker","lineMarker","nameRemoveTimeMap","nameAnimationDelay","nameAnimationDuration","nameRemoveTime","nameHolder","cursorHolder","Deactivated","Map","cursorPos","removeCursor","Activated","cursorCoords","bottom","createElement","classList","add","borderLeftColor","addEventListener","has","get","remove","appendChild","animationDuration","animationDelay","contains","delete","setAttribute","setBookmark","widget","insertLeft","showCursorNameReserve","fromPos","toPos","removeLine","redColor","parseInt","slice","greenColor","blueColor","markText","css","textContent","invert","parentElement","resetRemoveNameReserve","removeNameReserve","set","clear","SlideView","marpit","Marpit","inlineSVG","themeSet","default","markdown","render","Vim","defineEx","params","lineStart","firstLine","lineEnd","lastLine","curStart","Pos","curEnd","getRange","j","floor","replaceRange","Color","ToolType","dark","common","white","background","paper","CodeEditor","forwardedRef","cursorMapRef","editor","setEditor","connectCursor","disconnectCursor","getCmInstanceCallback","goHeadingLink","cmInstance","searchText","decodeURIComponent","hash","replace","getSearchCursor","find","setCursor","from","scrollIntoView","focus","updateCursor","pos","syncText","subscribe","actor","change","getID","getActorID","isActive","posFromIndex","on","instance","metaKey","coordsChar","clientX","clientY","token","getTokenAt","string","origin","indexFromPos","to","edit","ranges","anchor","head","changeEventHandler","changes","updateLine","getRoot","onChanges","addKeyMap","setOption","clearHistory","opts","spellChecker","placeholder","maxHeight","NAVBAR_HEIGHT","toolbar","unorderedListStyle","shortcuts","toggleUnorderedList","Slide","slideView","previewRender","previewElement","html","self","innerHTML","ThemeType","getCodemirrorInstance","initialBoardState","Yellow","toolType","None","boardSlice","toggleBoard","setTool","setColor","Event","callbacks","cb","idx","findIndex","splice","EventDispatcher","events","args","off","CanvasWrapper","canvas","context","getContext","lineWidth","lineCap","setWidth","setHeight","devicePixelRatio","clearRect","getWidth","getHeight","setSize","scale","drawTrace","points","strokeStyle","beginPath","moveTo","x","y","lineTo","stroke","drawLine","prevP","currentP","diffX","diffY","newPoints","flat","curves","fitCurve","save","firstCurve","curve","bezierCurveTo","closePath","restore","drawEraser","isMoved","fixEraserPoint","point","getSqDist","p1","p2","dx","dy","getSqSegDist","t","douglasPeuckerStep","first","last","tolerance","simplified","maxDist","dist","douglasPeucker","simplifyRadialDist","prevPoint","len","compressPoints","checkLineIntersection","point1Start","point1End","point2Start","point2End","b","onLine1","onLine2","denominator","numerator1","numerator2","cloneBox","isInnerBox","offsetY","offsetX","isSelectable","shape","drawRect","rect","strokeRect","addEvent","el","fn","capturing","removeEvent","removeEventListener","touch","mouseup","mouseout","mousedown","mousemove","touchy","work","Worker","createID","getElementByID","deleteByID","LineWorker","Line","previewLine","createLine","flushTask","lastShape","getLast","drawAll","RectWorker","Rect","previewRect","createRect","rectPoint","aWidth","abs","aHeight","adjustRectBox","tasks","doWork","requestTask","isDone","reserveTask","task","_work","DragStatus","EraserWorker","Eraser","eraserBoxSize","selectPoint","eraserPoints","scheduler","pointStart","pointEnd","findAndRemoveShape","point1","point2","shapePoint1","shapePoint2","eraserBox","SelectorWorker","Selector","selectedShape","findTarget","isEmptySelectedShape","NoneWorker","Board","Black","dragStatus","Stop","lowerWrapper","upperWrapper","presenceMap","worker","createUpperWrapper","initialize","initializeSize","initializeOffset","emit","bind","onMouseUp","onMouseOut","onMouseDown","onMouseMove","getCanvas","destroyUpperCanvas","getBoundingClientRect","resize","wrapper","parentNode","upperCanvas","removeChild","tool","setMouseClass","createWorker","Clear","Settings","TypeError","evt","originY","originX","TouchEvent","touches","scrollY","scrollX","Drag","getPointFromTouchyEvent","boardPresence","isOutside","peerKey","clearAll","DrawingBoard","canvasRef","boardRef","boardState","destroy","unsubscribe","documentKey","getKey","clientId","handleUpdateMeta","handleMouseup","clearBoard","SvgIcon","version","viewBox","d","Mouse","xmlns","enableBackground","minWidth","header","borderBottom","pointerEvents","itemTitle","whiteSpace","itemInfo","paddingLeft","textAlign","debounceSave","debounce","handleInputUserName","handleInputUserColor","handlePreviewChange","handleChange","handleThemeChanged","checked","FormControl","TextField","defaultValue","onInput","onChange","Select","displayEmpty","MenuItem","Switch","marginLeft","flexWrap","colorIcon","badge","ButtonWithColor","Icon","tooltip","currentToolType","handleSelectTool","Badge","nextColor","_color","selected","flexDirection","divider","marginBottom","Sidebar","nextTool","handleSettingsClick","handleSettingsClose","BrushIcon","RectIcon","Divider","flex","codeEditor","Editor","divRef","codeEditorRef","handleClickEditor","onResize","docKey","attachDocAsync","Snackbar","Alert","severity","CircularProgress","messageSlice","showMessage","hideMessage","getTitle","trim","tabListDark","tabListLight","drawer","flexShrink","transform","boxSizing","transition","paddingTop","paddingBottom","textTransform","listItemText","overflow","textOverflow","listSubHeader","visibility","listItem","sidebarItem","level0","level1","level2","level3","level4","level5","level6","level7","level8","level9","level10","moreMenu","MoreIcon","ExpandMore","e","stopPropagation","preventDefault","ChevronRight","headingOptions","groupOptions","MoreMenu","startRename","React","useParams","dialogOpen","setDialogOpen","handleDialogClose","openSnackbar","setOpenSnackbar","handleDeleteLink","handleCreateLink","handleUpdateLink","handleCreateCurrentPage","command","then","MoreHoriz","MenuListProps","PaperProps","option","ListItemIcon","Delete","SubdirectoryArrowLeft","Edit","OpenInBrowser","Update","Star","ListItemText","autoHideDuration","HeadingMoreMenu","GroupMoreMenu","disableRipple","InsertDriveFile","CreateNewFolder","GroupItem","loopType","isRename","setIsRename","textRef","isView","ListSubheader","onDoubleClick","Input","onBlur","onKeyUp","FolderOpen","Add","SidebarItem","history","useHistory","setOpenCallback","handleRename","EventNote","HeadingIcon","textShadow","HeadingItem","SideBarItemList","Collapse","unmountOnExit","GroupView","TabLabel","gap","TabPanelHeader","tools","SideBar","navState","favorites","linkRef","showTreeNode","parentList","currentDepth","searchPath","found","newOpens","findItem","Drawer","TabContext","TabList","scrollButtons","Tab","label","ListAlt","TabPanel","AccountTree","sidebarArea","zIndex","layout","editorArea","MessagePanel","messageState","handleCloseSnackbar","SpeedDialPanel","reverse","recentFavoriteSelector","openSpeedDial","setOpenSpeedDial","SpeedDial","ariaLabel","icon","SpeedDialIcon","onOpen","direction","SpeedDialAction","QuestionAnswer","tooltipTitle","RecordVoiceOver","DocPage","useLocation","ReactGA","send","NavBar","createBrowserHistory","Sentry","dsn","release","integrations","Integrations","BrowserTracing","routingInstrumentation","tracesSampleRate","App","createMuiTheme","handleRender","ThemeProvider","CssBaseline","path","exact","component","rootReducer","combineReducers","docReducer","peerReducer","settingReducer","boardReducer","linkReducer","messageReducer","navReducer","store","configureStore","reducer","middleware","getDefaultMiddleware","serializableCheck","ignoredActions","ignoredPaths","immutableCheck","hostname","trackingCode","ReactDOM","serviceWorker","ready","registration","unregister","catch","error","console"],"mappings":"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","file":"static/js/main.21705c61.chunk.js","sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport BrowserStorage from 'utils/storage';\n\nexport enum Theme {\n  Dark = 'dark',\n  Light = 'light',\n}\n\nexport enum CodeKeyMap {\n  Sublime = 'sublime',\n  Vim = 'vim',\n  Emacs = 'emacs',\n}\n\nexport enum TabSize {\n  Two = '2',\n  Four = '4',\n  Eight = '8',\n}\n\nexport type MenuKey = 'theme' | 'codeKeyMap' | 'tabSize' | 'userName' | 'userColor';\n\nexport type Menu = Record<MenuKey, string>;\n\nexport interface SettingState {\n  menu: Menu;\n}\n\nconst SettingModel = new BrowserStorage<SettingState>('$$codepair$$setting');\n\nconst prefersDark: boolean = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;\n\nconst initialState: SettingState = SettingModel.getValue({\n  menu: {\n    theme: prefersDark ? Theme.Dark : Theme.Light,\n    codeKeyMap: CodeKeyMap.Sublime,\n    tabSize: TabSize.Two,\n    userName: '',\n    userColor: '',\n  },\n});\n\nconst settingSlice = createSlice({\n  name: 'setting',\n  initialState,\n  reducers: {\n    setDarkMode(state, action: PayloadAction<boolean>) {\n      state.menu.theme = action.payload ? Theme.Dark : Theme.Light;\n      SettingModel.setValue(state);\n    },\n\n    setCodeKeyMap(state, action: PayloadAction<CodeKeyMap>) {\n      state.menu.codeKeyMap = action.payload;\n      SettingModel.setValue(state);\n    },\n\n    setTabSize(state, action: PayloadAction<TabSize>) {\n      state.menu.tabSize = action.payload;\n      SettingModel.setValue(state);\n    },\n    setUserName(state, action: PayloadAction<string>) {\n      state.menu.userName = action.payload;\n      SettingModel.setValue(state);\n    },\n    setUserColor(state, action: PayloadAction<string>) {\n      state.menu.userColor = action.payload;\n      SettingModel.setValue(state);\n    },\n  },\n});\n\nexport const { setDarkMode, setCodeKeyMap, setTabSize, setUserName, setUserColor } = settingSlice.actions;\nexport default settingSlice.reducer;\n","export default class BrowserStorage<T> {\n  key: string;\n\n  storage: Storage;\n\n  constructor(key: string) {\n    this.key = key;\n    this.storage = window.localStorage;\n  }\n\n  getValue(initial: T): T {\n    try {\n      return JSON.parse(this.storage[this.key]) as T;\n    } catch {\n      return initial;\n    }\n  }\n\n  setValue(value: T) {\n    this.storage[this.key] = JSON.stringify(value);\n  }\n}\n","import React, { ReactNode } from 'react';\nimport { Popover as MaterialPopover, PopoverOrigin } from '@material-ui/core';\n\ninterface PopoverProps {\n  anchorEl: Element | undefined;\n  onClose: (event: {}, reason: 'backdropClick' | 'escapeKeyDown') => void;\n  children: ReactNode;\n  anchorOrigin?: PopoverOrigin;\n  transformOrigin?: PopoverOrigin;\n}\n\n/**\n * @see https://material-ui.com/components/popover/#popover\n */\nexport default function Popover({ anchorEl, onClose, children, anchorOrigin, transformOrigin }: PopoverProps) {\n  const isOpen = Boolean(anchorEl);\n\n  return (\n    <MaterialPopover\n      id={isOpen ? 'simple-popover' : undefined}\n      open={isOpen}\n      anchorEl={anchorEl}\n      onClose={onClose}\n      anchorOrigin={anchorOrigin}\n      transformOrigin={transformOrigin}\n    >\n      {children}\n    </MaterialPopover>\n  );\n}\n\nPopover.defaultProps = {\n  anchorOrigin: {\n    vertical: 'bottom',\n    horizontal: 'center',\n  },\n  transformOrigin: {\n    vertical: 'top',\n    horizontal: 'center',\n  },\n};\n","import { createSlice, PayloadAction, createAsyncThunk } from '@reduxjs/toolkit';\nimport { ActorID } from 'yorkie-js-sdk';\nimport { DocState } from './docSlices';\n\nexport interface Presence {\n  username: string;\n  color: string;\n  image: string; // Currently all anonymous images\n  board: string;\n}\n\nexport enum ConnectionStatus {\n  Connected = 'connected',\n  Disconnected = 'disconnected',\n}\n\nexport interface Peer {\n  id: ActorID;\n  status: ConnectionStatus;\n  presence: Presence;\n  isMine: boolean;\n}\n\nexport interface PeerState {\n  peers: Record<string, Peer>;\n}\n\nexport interface SyncPeerPayLoad {\n  myClientID: ActorID;\n  changedPeers: Record<string, Presence>;\n}\n\nconst initialPeerState: PeerState = {\n  peers: {},\n};\n\nconst peerSlice = createSlice({\n  name: 'peer',\n  initialState: initialPeerState,\n  reducers: {\n    syncPeer(state, action: PayloadAction<SyncPeerPayLoad>) {\n      const { myClientID, changedPeers } = action.payload;\n      const { peers } = state;\n\n      for (const clientID of Object.keys(peers)) {\n        if (!changedPeers[clientID]) {\n          peers[clientID].status = ConnectionStatus.Disconnected;\n        }\n      }\n\n      for (const [clientID, presence] of Object.entries(changedPeers)) {\n        if (!peers[clientID] || peers[clientID].status === ConnectionStatus.Disconnected) {\n          const peer = {\n            id: clientID,\n            status: ConnectionStatus.Connected,\n            presence,\n            isMine: myClientID === clientID,\n          };\n          state.peers[clientID] = peer;\n        }\n      }\n    },\n  },\n});\n\nexport const updatePresenceColor = createAsyncThunk<undefined, string, { rejectValue: string }>(\n  'presence/update',\n  (newColor, thunkApi) => {\n    try {\n      const state = thunkApi.getState() as any;\n      const { docState }: { docState: DocState } = state;\n      const { client } = docState;\n\n      const userColor = newColor;\n      client?.updatePresence('color', userColor);\n\n      return undefined;\n    } catch (err) {\n      return thunkApi.rejectWithValue((err as Error).message);\n    }\n  },\n);\n\nexport const { syncPeer } = peerSlice.actions;\nexport default peerSlice.reducer;\n","import React from 'react';\nimport ListItem from '@material-ui/core/ListItem';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport { Peer } from 'features/peerSlices';\n\ninterface PeerListItemProps {\n  peer: Peer;\n}\n\nconst useStyles = makeStyles(() => ({\n  root: (props: PeerListItemProps) => ({\n    color: props.peer.presence.color,\n  }),\n}));\n\nexport default function PeerListItem(props: PeerListItemProps) {\n  const classes = useStyles(props);\n  const { peer } = props;\n\n  return <ListItem className={classes.root}>{peer.presence.username}</ListItem>;\n}\n","/* eslint-disable @typescript-eslint/indent */\n/* eslint-disable @typescript-eslint/no-unused-vars */\nimport { useMemo } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { AppState } from 'app/rootReducer';\nimport { ConnectionStatus } from 'features/peerSlices';\n\nexport default function usePeer() {\n  const client = useSelector((state: AppState) => state.docState.client);\n  const peers = useSelector((state: AppState) => state.peerState.peers);\n\n  const activePeers = useMemo(() => {\n    if (!client) {\n      return [];\n    }\n    return Object.values(peers).filter((peer) => peer.status === ConnectionStatus.Connected);\n  }, [client, peers]);\n\n  return { activePeers };\n}\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\n\nimport PeerListItem from 'components/NavBar/PeerListItem';\nimport usePeer from 'hooks/usePeer';\n\nexport default function PeerList() {\n  const { activePeers } = usePeer();\n\n  return (\n    <List>\n      <ListItem>\n        <Typography>Total {activePeers.length}</Typography>\n      </ListItem>\n      {activePeers.map((peer) => {\n        return <PeerListItem key={peer.id} peer={peer} />;\n      })}\n    </List>\n  );\n}\n","import React, { useState, useCallback, MouseEvent } from 'react';\nimport { useSelector } from 'react-redux';\nimport Avatar from '@material-ui/core/Avatar';\nimport AvatarGroup from '@material-ui/lab/AvatarGroup';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles } from '@material-ui/core/styles';\nimport anonymous from 'anonymous-animals-gen';\n\nimport Popover from 'components/commons/Popover';\nimport PeerList from 'components/NavBar/PeerList';\nimport { AppState } from 'app/rootReducer';\nimport usePeer from 'hooks/usePeer';\n\nconst useStyles = makeStyles((theme) => ({\n  group: {\n    '& > *': {\n      cursor: 'pointer',\n    },\n  },\n  myAvatar: {\n    borderColor: theme.palette.secondary.main,\n    '&:before': {\n      content: '\"\"',\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      borderRadius: '50%',\n      border: `2px solid ${theme.palette.secondary.main}`,\n    },\n  },\n}));\n\nconst MAX_PEER_VIEW = 4;\n\nexport default function PeerGroup() {\n  const classes = useStyles();\n  const client = useSelector((state: AppState) => state.docState.client);\n  const peers = useSelector((state: AppState) => state.peerState.peers);\n  const { activePeers } = usePeer();\n  const [anchorEl, setAnchorEl] = useState<Element | undefined>();\n\n  const handleViewList = useCallback(\n    (event: MouseEvent<Element>) => {\n      const target = event.target as HTMLTextAreaElement;\n      if (!target.getAttribute('data-id')) {\n        setAnchorEl(event.currentTarget);\n      }\n    },\n    [setAnchorEl],\n  );\n\n  const handleViewListClose = useCallback(() => {\n    setAnchorEl(undefined);\n  }, [setAnchorEl]);\n\n  if (!client) {\n    // NOTE: We use null as an exception to prevent component from rendering.\n    return null;\n  }\n\n  return (\n    <>\n      <AvatarGroup className={classes.group} max={MAX_PEER_VIEW} onClick={handleViewList}>\n        {activePeers.map((peer) => {\n          const { username, color, image } = peers[peer.id].presence;\n          return (\n            <Tooltip key={peer.id} title={peer.isMine ? `[ME] ${username}` : username} data-id={peer.id} arrow>\n              <Avatar\n                alt=\"Peer Image\"\n                className={peer.isMine ? classes.myAvatar : ''}\n                style={{ backgroundColor: color, width: 34, height: 34 }}\n                src={anonymous.getImage(image)}\n              />\n            </Tooltip>\n          );\n        })}\n      </AvatarGroup>\n      <Popover anchorEl={anchorEl} onClose={handleViewListClose}>\n        <PeerList />\n      </Popover>\n    </>\n  );\n}\n","import React from 'react';\nimport { createStyles, Theme, withStyles, WithStyles } from '@material-ui/core/styles';\nimport MaterialDialog, { DialogProps as MaterialDialogProps } from '@material-ui/core/Dialog';\nimport MuiDialogTitle from '@material-ui/core/DialogTitle';\nimport MuiDialogContent from '@material-ui/core/DialogContent';\nimport MuiDialogActions from '@material-ui/core/DialogActions';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport Typography from '@material-ui/core/Typography';\n\nexport { DialogContentText } from '@material-ui/core';\n\nconst styles = (theme: Theme) =>\n  createStyles({\n    root: {\n      margin: 0,\n      padding: theme.spacing(2),\n    },\n    closeButton: {\n      position: 'absolute',\n      right: theme.spacing(1),\n      top: theme.spacing(1),\n      color: theme.palette.grey[500],\n    },\n  });\n\ninterface DialogTitleProps extends WithStyles<typeof styles> {\n  children: React.ReactNode;\n  onClose?: () => void;\n}\n\nexport const DialogTitle = withStyles(styles)((props: DialogTitleProps) => {\n  const { children, classes, onClose, ...other } = props;\n  return (\n    <MuiDialogTitle disableTypography className={classes.root} {...other}>\n      <Typography variant=\"h6\">{children}</Typography>\n      {onClose ? (\n        <IconButton aria-label=\"close\" className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      ) : null}\n    </MuiDialogTitle>\n  );\n});\n\nexport const DialogContent = withStyles((theme: Theme) => ({\n  root: {\n    padding: theme.spacing(2),\n  },\n}))(MuiDialogContent);\n\nexport const DialogActions = withStyles((theme: Theme) => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1),\n  },\n}))(MuiDialogActions);\n\ninterface DialogProps extends MaterialDialogProps {\n  open: boolean;\n  onClose: () => void;\n  className?: string;\n  children: React.ReactNode;\n}\n\n/**\n * {@see https://material-ui.com/components/dialogs/#customized-dialogs}\n */\nfunction Dialog({ open, onClose, className, children }: DialogProps) {\n  if (!open) {\n    return null;\n  }\n\n  return (\n    <MaterialDialog onClose={onClose} open={open} maxWidth=\"md\">\n      <div className={className}>{children}</div>\n    </MaterialDialog>\n  );\n}\n\nDialog.defaultProps = {\n  className: '',\n};\n\nexport default Dialog;\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect, useRef, ReactNode } from 'react';\nimport MaterialFade from '@material-ui/core/Fade';\n\ninterface FadeProps {\n  timeout?: number;\n  show: boolean;\n  onFadeout: Function;\n  children: ReactNode;\n}\n\nfunction Fade({ timeout, show, onFadeout, children }: FadeProps) {\n  const timeoutId = useRef<number | null>(null);\n\n  useEffect(() => {\n    if (show) {\n      timeoutId.current = window.setTimeout(() => {\n        onFadeout();\n        timeoutId.current = null;\n      }, timeout);\n    }\n\n    return () => {\n      if (timeoutId.current) {\n        clearTimeout(timeoutId.current);\n      }\n    };\n  }, [show]);\n\n  return (\n    <MaterialFade in={show}>\n      <div>{show ? children : null}</div>\n    </MaterialFade>\n  );\n}\n\nFade.defaultProps = {\n  timeout: 1000,\n};\n\nexport default Fade;\n","import { createSlice, PayloadAction, createAsyncThunk } from '@reduxjs/toolkit';\nimport yorkie, { Client, Document, Text, TimeTicket } from 'yorkie-js-sdk';\nimport anonymous from 'anonymous-animals-gen';\nimport randomColor from 'randomcolor';\nimport { Presence } from 'features/peerSlices';\nimport { SettingState } from './settingSlices';\nimport { LinkItemType } from './linkSlices';\n\nexport enum Preview {\n  HTML = 'html',\n  Slide = 'slide',\n}\n\nexport enum CodeMode {\n  Markdown = 'gfm',\n  Go = 'go',\n  JavaScript = 'javascript',\n  Clojure = 'clojure',\n  Dart = 'dart',\n  Python = 'python',\n  Ruby = 'ruby',\n  Rust = 'rust',\n}\n\nexport type Point = {\n  y: number;\n  x: number;\n};\n\nexport interface Box {\n  y: number;\n  x: number;\n  width: number;\n  height: number;\n}\n\n// TODO(ppeeou): refer to yorkie-sdk-js ArrayProxy\nexport interface BaseShape {\n  type: string;\n  getID(): TimeTicket;\n}\n\nexport interface Line extends BaseShape {\n  type: 'line';\n  color: string;\n  points: Array<Point>;\n}\n\nexport interface EraserLine extends BaseShape {\n  type: 'eraser';\n  points: Array<Point>;\n}\n\nexport interface Rect extends BaseShape {\n  type: 'rect';\n  color: string;\n  points: Array<Point>;\n  box: Box;\n}\n\nexport type Shape = Line | EraserLine | Rect;\n\nexport type ShapeType = Shape['type'];\n\nexport type CodePairDoc = {\n  mode: CodeMode;\n  preview: Preview;\n  content: Text;\n  shapes: Array<Shape>;\n};\n\n// TODO(ppeeou): refer to yorkie-sdk-js ArrayProxy\nexport interface Shapes {\n  push(shape: Shape): number;\n\n  getLast(): Shape;\n  getElementByID(createdAt: TimeTicket): Shape;\n  deleteByID(createdAt: TimeTicket): Shape;\n  length: number;\n  [index: number]: Shape;\n  [Symbol.iterator](): IterableIterator<Shape>;\n}\n\n//  TODO(ppeeou) refer to yorkie-sdk-js JSONObject\nexport interface Root {\n  shapes: Shapes & Array<Shape>;\n}\n\nexport enum DocStatus {\n  Disconnect = 'disconnect',\n  Connect = 'connect',\n}\n\nexport interface DocState {\n  client?: Client<Presence>;\n  doc?: Document<CodePairDoc>;\n  mode: CodeMode;\n  preview: Preview;\n  loading: boolean;\n  errorMessage: string;\n  status: DocStatus;\n  headings: LinkItemType[];\n}\n\nconst initialState: DocState = {\n  mode: CodeMode.Markdown,\n  preview: Preview.HTML,\n  loading: true,\n  errorMessage: '',\n  status: DocStatus.Connect,\n  headings: [],\n};\n\ninterface Heading {\n  level: number;\n  text: string;\n  originalText?: string;\n}\n\nfunction generateTableOfContents(editorInstance: CodeMirror.Editor, count = Number.MAX_SAFE_INTEGER): Heading[] {\n  const doc = editorInstance.getDoc();\n  const lineCount = doc.lineCount();\n  const headings = [];\n\n  for (let i = 0; i < lineCount; i += 1) {\n    const line = doc.getLine(i);\n\n    // check only header\n    const tokens = editorInstance.getTokenTypeAt({ line: i, ch: 1 }) || '';\n    if (tokens?.includes('header') === false) continue;\n\n    const match = line.match(/^(#+)\\s+(.*)/);\n    if (match) {\n      const level = match[1].length;\n      const text = match[2];\n      headings.push({ level, text, originalText: line });\n\n      if (headings.length >= count) {\n        break;\n      }\n    }\n  }\n\n  return headings;\n}\n\nexport function getTableOfContents(count = Number.MAX_SAFE_INTEGER): Heading[] {\n  const cm = document.querySelector('.CodeMirror');\n\n  if (cm) {\n    const { CodeMirror } = cm as any;\n\n    return generateTableOfContents(CodeMirror, count);\n  }\n\n  return [];\n}\n\nexport const activateClient = createAsyncThunk<ActivateClientResult, undefined, { rejectValue: string }>(\n  'doc/activate',\n  async (_: undefined, thunkApi) => {\n    try {\n      const { name, animal } = anonymous.generate();\n      const state: SettingState = (thunkApi.getState() as any).settingState;\n      const { userName, userColor } = state.menu;\n      const options = {\n        apiKey: '',\n        presence: {\n          username: userName || name,\n          image: animal,\n          color: userColor || randomColor(),\n          board: '',\n        },\n      };\n\n      if (`${process.env.REACT_APP_YORKIE_API_KEY}`) {\n        options.apiKey = `${process.env.REACT_APP_YORKIE_API_KEY}`;\n      }\n\n      const client = new yorkie.Client(`${process.env.REACT_APP_YORKIE_RPC_ADDR}`, options);\n\n      await client.activate();\n      return { client };\n    } catch (err) {\n      return thunkApi.rejectWithValue((err as Error).message);\n    }\n  },\n);\n\nexport const attachDoc = createAsyncThunk<AttachDocResult, AttachDocArgs, { rejectValue: string }>(\n  'doc/attach',\n  async ({ client, doc }, thunkApi) => {\n    try {\n      await client.attach(doc);\n\n      doc.update((root) => {\n        // codeEditor\n        if (!root.content) {\n          root.content = new yorkie.Text();\n        }\n        // board\n        if (!root.shapes) {\n          root.shapes = [];\n        }\n      });\n      await client.sync();\n      return { doc, client };\n    } catch (err) {\n      return thunkApi.rejectWithValue((err as Error).message);\n    }\n  },\n);\n\nconst docSlice = createSlice({\n  name: 'doc',\n  initialState,\n  reducers: {\n    deactivateClient(state) {\n      const { client } = state;\n      state.client = undefined;\n      client?.deactivate();\n    },\n    createDocument(state, action: PayloadAction<string>) {\n      state.doc = new yorkie.Document<CodePairDoc>(`codepairs-${action.payload}`);\n    },\n    detachDocument(state) {\n      const { doc, client } = state;\n      state.doc = undefined;\n      client?.detach(doc as Document<CodePairDoc>);\n    },\n    attachDocLoading(state, action: PayloadAction<boolean>) {\n      state.loading = action.payload;\n    },\n    setCodeMode(state, action: PayloadAction<CodeMode>) {\n      state.mode = action.payload;\n    },\n    setPreview(state, action: PayloadAction<Preview>) {\n      state.preview = action.payload;\n    },\n    setStatus(state, action: PayloadAction<DocStatus>) {\n      state.status = action.payload;\n    },\n\n    updateHeadings(state) {\n      state.headings = getTableOfContents().map((it, index) => {\n        return {\n          type: 'link',\n          id: `heading-#${encodeURIComponent(it.originalText || '')}-${index}`,\n          name: it.text,\n          level: it.level - 1,\n          fileLink: `${window.location.pathname}#${encodeURIComponent(it.originalText || '')}`,\n          linkType: 'heading',\n        } as LinkItemType;\n      });\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(activateClient.fulfilled, (state, { payload }) => {\n      state.client = payload.client;\n    });\n    builder.addCase(activateClient.rejected, (state, { payload }) => {\n      state.errorMessage = payload!;\n    });\n    builder.addCase(attachDoc.fulfilled, (state, { payload }) => {\n      state.doc = payload.doc;\n      state.client = payload.client;\n    });\n    builder.addCase(attachDoc.rejected, (state, { payload }) => {\n      state.errorMessage = payload!;\n    });\n  },\n});\n\nexport const {\n  deactivateClient,\n  createDocument,\n  detachDocument,\n  attachDocLoading,\n  setPreview,\n  setCodeMode,\n  setStatus,\n  updateHeadings,\n} = docSlice.actions;\nexport default docSlice.reducer;\n\ntype ActivateClientResult = { client: Client<Presence> };\ntype AttachDocArgs = { doc: Document<CodePairDoc>; client: Client<Presence> };\ntype AttachDocResult = { doc: Document<CodePairDoc>; client: Client<Presence> };\n","import React, { useState, useCallback, useRef } from 'react';\nimport { useSelector } from 'react-redux';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport Typography from '@material-ui/core/Typography';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport GroupIcon from '@material-ui/icons/Group';\nimport FileCopyIcon from '@material-ui/icons/FileCopy';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport Dialog, { DialogTitle, DialogContent, DialogActions, DialogContentText } from 'components/commons/Dialog';\nimport Fade from 'components/commons/Fade';\nimport { AppState } from 'app/rootReducer';\nimport { DocStatus } from 'features/docSlices';\nimport QRCode from 'react-qr-code';\n\nconst useStyles = makeStyles(() => ({\n  dialog: {\n    borderRadius: '4px',\n  },\n  input: {\n    width: '300px',\n    padding: '12px 8px',\n    fontSize: '18px',\n    borderRadius: '5px',\n    outline: 'none',\n    backgroundColor: 'hsla(0,0%,100%,0.9)',\n  },\n  box: {\n    '@media only screen and (max-width: 600px)': {\n      display: 'none',\n    },\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  button: {\n    lineHeight: '24px',\n  },\n}));\n\nexport default function ShareButton() {\n  const classes = useStyles();\n  const status = useSelector((state: AppState) => state.docState.status);\n  const [open, setOpen] = useState(false);\n  const [showCopyText, setShowCopyText] = useState(false);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const copyUrl = window.location.href.split('?')[0];\n\n  const onFocus = useCallback(() => {\n    inputRef.current?.select();\n  }, []);\n\n  const onCopy = useCallback(() => {\n    setShowCopyText(true);\n  }, []);\n\n  const openModal = useCallback(() => {\n    setOpen(true);\n  }, []);\n\n  const closeModal = useCallback(() => {\n    setOpen(false);\n  }, []);\n\n  return (\n    <div className={classes.box}>\n      <Button\n        className={classes.button}\n        size=\"small\"\n        color=\"primary\"\n        variant=\"contained\"\n        startIcon={<GroupIcon />}\n        onClick={openModal}\n        disabled={status === DocStatus.Disconnect}\n      >\n        Share\n      </Button>\n      <Dialog open={open} onClose={closeModal} className={classes.dialog}>\n        <DialogTitle onClose={closeModal}>Share Code</DialogTitle>\n        <DialogContent dividers>\n          <Box my={3}>\n            <Typography>Anyone can access the code in real time through this URL.</Typography>\n          </Box>\n          <Box my={1}>\n            <DialogContentText>Share this URL</DialogContentText>\n          </Box>\n          <Box display=\"flex\">\n            <input readOnly ref={inputRef} className={classes.input} value={copyUrl} onFocus={onFocus} />\n            <CopyToClipboard text={copyUrl} onCopy={onCopy}>\n              <IconButton color=\"primary\">\n                <FileCopyIcon />\n              </IconButton>\n            </CopyToClipboard>\n            <Fade show={showCopyText} onFadeout={() => setShowCopyText(false)}>\n              <p>Copy!</p>\n            </Fade>\n          </Box>\n          <Box my={1} style={{ marginTop: 10 }}>\n            <DialogContentText>QRCode</DialogContentText>\n          </Box>\n          <Box>\n            <IconButton aria-label=\"selector\">\n              <QRCode value={copyUrl} style={{ width: 150, height: 150 }} />\n            </IconButton>\n          </Box>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={closeModal} color=\"primary\" variant=\"contained\" autoFocus>\n            Close\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React, { useState, useCallback, MouseEvent } from 'react';\nimport { useSelector } from 'react-redux';\nimport Box from '@material-ui/core/Box';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport CloudDoneIcon from '@material-ui/icons/CloudDone';\nimport CloudOffIcon from '@material-ui/icons/CloudOff';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\n\nimport Popover from 'components/commons/Popover';\nimport { AppState } from 'app/rootReducer';\nimport { DocStatus } from 'features/docSlices';\n\ninterface NetworkAlertProps {\n  title: string;\n  subTitle: string;\n  content: string;\n}\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      width: '380px',\n    },\n    title: {\n      backgroundColor: 'hsla(0,0%,100%,0.1)',\n      '& > *': {\n        fontWeight: 'bold',\n      },\n    },\n  }),\n);\n\nfunction NetworkAlert({ title, subTitle, content }: NetworkAlertProps) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.root}>\n      <Box px={2} py={1.5} className={classes.title}>\n        <Typography variant=\"subtitle1\">{title}</Typography>\n      </Box>\n      <Box px={2} p={1}>\n        <Box py={1}>\n          <Typography variant=\"body1\">{subTitle}</Typography>\n        </Box>\n\n        <Box pb={2.5}>\n          <Typography variant=\"body2\">{content}</Typography>\n        </Box>\n      </Box>\n    </div>\n  );\n}\n\nfunction NetworkDisconnect(props: { hasLocalChanges: boolean }) {\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | undefined>();\n  const { hasLocalChanges } = props;\n  const handleOpen = useCallback((event: MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  }, []);\n\n  const handleClose = useCallback(() => {\n    setAnchorEl(undefined);\n  }, []);\n\n  return (\n    <>\n      <Button aria-label=\"doc-status\" color=\"secondary\" startIcon={<CloudOffIcon />} onClick={handleOpen}>\n        Working offline\n      </Button>\n\n      <Popover\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n      >\n        <NetworkAlert\n          title={hasLocalChanges ? \"There are changes that couldn't be sent to Server\" : 'All Changes saved to Server'}\n          subTitle=\"This document is ready for offline use\"\n          content=\"Looks like you're offline. Changes will save to this memory now, and save to Server once reconnected.\"\n        />\n      </Popover>\n    </>\n  );\n}\n\nfunction NetworkConnect() {\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | undefined>();\n  const handleOpen = useCallback((event: MouseEvent<HTMLButtonElement>) => {\n    setAnchorEl(event.currentTarget);\n  }, []);\n\n  const handleClose = useCallback(() => {\n    setAnchorEl(undefined);\n  }, []);\n\n  return (\n    <>\n      <Button aria-label=\"doc-status\" color=\"secondary\" onClick={handleOpen}>\n        <CloudDoneIcon />\n      </Button>\n\n      <Popover\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n      >\n        <NetworkAlert\n          title=\"All Changes saved to Server\"\n          subTitle=\"This document is ready for offline use\"\n          content=\"You can edit this document without an internet connection. Changes will save to Server once reconnected.\"\n        />\n      </Popover>\n    </>\n  );\n}\n\nexport default function NetworkButton() {\n  const status = useSelector((state: AppState) => state.docState.status);\n  const hasLocalChanges = useSelector((state: AppState) => {\n    return state.docState.doc ? state.docState.doc.hasLocalChanges() : false;\n  });\n\n  if (status === DocStatus.Connect) {\n    return <NetworkConnect />;\n  }\n  return <NetworkDisconnect hasLocalChanges={hasLocalChanges} />;\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nexport type NavTabType = 'notes' | 'toc';\n\nexport interface NavState {\n  openTab: boolean;\n  openTabValue: NavTabType;\n}\n\nconst initialNavState: NavState = {\n  openTab: false,\n  openTabValue: 'notes',\n};\n\nconst navSlice = createSlice({\n  name: 'nav',\n  initialState: initialNavState,\n\n  reducers: {\n    toggleTab(state) {\n      state.openTab = !state.openTab;\n    },\n    toggleLinkTab(state, action: PayloadAction<NavTabType>) {\n      state.openTabValue = action.payload;\n    },\n  },\n});\n\nexport const { toggleTab, toggleLinkTab } = navSlice.actions;\nexport default navSlice.reducer;\n","import React, { memo } from 'react';\nimport { IconButton, Link } from '@material-ui/core';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport PeerGroup from 'components/NavBar/PeerGroup';\nimport ShareButton from 'components/NavBar/ShareButton';\nimport NetworkButton from 'components/NavBar/NetworkButton';\nimport { useDispatch } from 'react-redux';\nimport { toggleTab } from 'features/navSlices';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n    },\n    appBar: {\n      backgroundColor: 'black',\n      color: 'white',\n    },\n    iconButton: {\n      marginRight: theme.spacing(2),\n      color: 'white',\n    },\n    grow: {\n      flexGrow: 1,\n    },\n    title: {\n      fontWeight: 'bold',\n      color: theme.palette.primary.main,\n      marginRight: theme.spacing(1),\n    },\n    yorkie: {\n      '& > a': {\n        textDecoration: 'none',\n        color: '#b5b0a1',\n        fontSize: 12,\n      },\n    },\n    items: {\n      display: 'flex',\n      '& > *': {\n        margin: theme.spacing(1),\n      },\n    },\n  }),\n);\n\nfunction MenuAppBar() {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"static\" className={classes.appBar}>\n        <Toolbar>\n          <IconButton\n            size=\"small\"\n            onClick={() => {\n              dispatch(toggleTab());\n            }}\n            className={classes.iconButton}\n          >\n            <MenuIcon />\n          </IconButton>\n          <Typography variant=\"h6\" className={classes.title}>\n            <Link href=\"/\" underline=\"none\">\n              CodePair\n            </Link>\n          </Typography>\n          <Typography className={classes.yorkie}>\n            <a href=\"https://yorkie.dev\" target=\"_blank\" rel=\"noreferrer\">\n              Powered by Yorkie\n            </a>\n          </Typography>\n          <NetworkButton />\n          <div className={classes.grow} />\n          <div className={classes.items}>\n            <ShareButton />\n            <PeerGroup />\n          </div>\n        </Toolbar>\n      </AppBar>\n    </div>\n  );\n}\n\nexport default memo(MenuAppBar);\n","import { getTableOfContents } from 'features/docSlices';\nimport { AppState } from 'app/rootReducer';\nimport BrowserStorage from 'utils/storage';\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nexport type ItemType = LinkItemType | GroupType;\n\nexport interface LinkItemType {\n  type: 'link';\n  level?: number;\n  id: string;\n  name: string;\n  fileLink?: string;\n  linkType?: string;\n  links?: LinkItemType[];\n}\n\nexport interface GroupType {\n  type: 'group';\n  id: string;\n  name: string;\n  links: ItemType[];\n}\n\nexport interface OpenState {\n  [key: string]: boolean;\n}\n\nexport interface LinkState {\n  opens: OpenState;\n  favorite: (string | LinkItemType)[];\n  groups: GroupType[];\n}\n\nfunction traverse(parent: any, data: any[], callback: (item: any, parent: any, depth: number) => void, depth = 0) {\n  data.forEach((item) => {\n    callback(item, parent, depth + 1);\n    traverse(item, item.links || [], callback, depth + 1);\n  });\n}\n\nfunction findOne(data: any[], callback: (item: any) => boolean) {\n  let result: any = null;\n  traverse(null, data, (item) => {\n    if (callback(item)) {\n      result = item;\n    }\n  });\n  return result;\n}\n\nfunction copyTextToClipboard(text: string) {\n  window.navigator.clipboard.writeText(text);\n}\n\nconst SettingModel = new BrowserStorage<LinkState>('$$codepair$$link');\n\nconst initialLinkState: LinkState = SettingModel.getValue({\n  favorite: [],\n  groups: [\n    {\n      type: 'group',\n      id: `${Date.now()}`,\n      name: 'Default Group',\n      links: [],\n    },\n  ],\n  opens: {},\n});\n\n// recover old data\ntraverse(initialLinkState, initialLinkState.groups, (item) => {\n  if (item.type === 'link') {\n    if (item.fileLink?.startsWith('/') !== true) {\n      item.fileLink = `/${item.fileLink}`;\n    }\n  } else if (item.linkType === 'pairy') {\n    if (item.fileLink?.startsWith('/') !== true) {\n      item.fileLink = `/${item.fileLink}`;\n    }\n    item.type = 'link';\n  }\n});\n\nconst linkSlice = createSlice({\n  name: 'link',\n  initialState: initialLinkState,\n\n  reducers: {\n    refreshStorage(state) {\n      const newValue = SettingModel.getValue(state);\n\n      state.favorite = newValue.favorite;\n      state.groups = newValue.groups;\n      state.opens = newValue.opens;\n    },\n    toggleFavorite(state, action: PayloadAction<string | LinkItemType>) {\n      const { payload } = action;\n\n      let favorite = state.favorite || [];\n\n      if (typeof payload === 'string') {\n        if (!favorite.includes(payload)) {\n          favorite.push(payload);\n        } else {\n          favorite = favorite.filter((id) => id !== payload);\n        }\n      } else if (typeof payload === 'object') {\n        const { fileLink } = payload;\n\n        if (!favorite.some((item) => (item as any)?.fileLink === fileLink)) {\n          favorite.push(payload);\n        } else {\n          favorite = favorite.filter((item) => (item as any)?.fileLink === fileLink);\n        }\n      }\n\n      state.favorite = favorite;\n\n      SettingModel.setValue(state);\n    },\n\n    toggleLinkOpen(state, action: PayloadAction<string>) {\n      const { payload } = action;\n      state.opens[payload] = !state.opens[payload];\n\n      if (state.opens[payload] === false) {\n        delete state.opens[payload];\n      }\n\n      SettingModel.setValue(state);\n    },\n    removeLink(state, action: PayloadAction<{ id: string }>) {\n      const { id } = action.payload;\n      traverse(state, state.groups, (item, parent) => {\n        if (item.id === id) {\n          parent.links = parent.links?.filter((link: any) => link.id !== id) || [];\n        }\n      });\n\n      SettingModel.setValue(state);\n    },\n\n    removeGroup(state, action: PayloadAction<{ id: string }>) {\n      const { id } = action.payload;\n      traverse(state, state.groups, (item, parent) => {\n        if (item.id === id) {\n          if (parent?.links) {\n            parent.links = parent.links.filter((link: any) => link.id !== id);\n          } else {\n            // root object\n\n            if (state.groups.length < 2) {\n              return;\n            }\n\n            parent.groups = parent.groups.filter((link: any) => link.id !== id);\n          }\n        }\n      });\n\n      SettingModel.setValue(state);\n    },\n    setLinkOpens(state, action: PayloadAction<OpenState>) {\n      state.opens = {\n        ...state.opens,\n        ...action.payload,\n      };\n\n      SettingModel.setValue(state);\n    },\n    setLinkName(state, action: PayloadAction<{ id: string; name: string }>) {\n      const { id, name } = action.payload;\n      const foundItem = findOne(state.groups, (item) => item.id === id);\n      if (foundItem) {\n        foundItem.name = name;\n      }\n\n      SettingModel.setValue(state);\n    },\n    updateLinkNameWithHeading(state) {\n      const heading = getTableOfContents(1)[0];\n      const currentLink = window.location.pathname;\n\n      if (!heading) return;\n\n      // const { id, name } = action.payload;\n      const foundItem = findOne(state.groups, (item) => {\n        return item.fileLink === currentLink;\n      });\n      if (foundItem) {\n        foundItem.name = heading.text;\n      }\n\n      SettingModel.setValue(state);\n    },\n    setLinkFileLink(state, action: PayloadAction<{ id: string; name: string; fileLink: string }>) {\n      const { id, name, fileLink } = action.payload;\n      const foundItem = findOne(state.groups, (item) => item.id === id);\n      if (foundItem) {\n        foundItem.fileLink = fileLink;\n        foundItem.name = name;\n      }\n\n      SettingModel.setValue(state);\n    },\n    newGroup(state, action: PayloadAction<string>) {\n      const { payload } = action;\n      state.groups = [\n        ...state.groups,\n        {\n          type: 'group',\n          id: `${Date.now()}`,\n          name: payload,\n          links: [],\n        },\n      ];\n\n      SettingModel.setValue(state);\n    },\n    newGroupAt(state, action: PayloadAction<{ id: string; name: string }>) {\n      const { payload } = action;\n\n      const newGroups: GroupType[] = [];\n      state.groups.forEach((group) => {\n        newGroups.push(group);\n        if (group.id === payload.id) {\n          newGroups.push({\n            type: 'group',\n            id: `${Date.now()}`,\n            name: payload.name,\n            links: [],\n          });\n        }\n      });\n\n      state.groups = newGroups;\n\n      SettingModel.setValue(state);\n    },\n    newChildGroupAt(state, action: PayloadAction<{ parentId: string; name: string }>) {\n      const { payload } = action;\n\n      const foundGroupItem = findOne(state.groups, (item) => item.id === payload.parentId);\n\n      if (foundGroupItem) {\n        const newGroup = {\n          type: 'group',\n          id: `${Date.now()}`,\n          name: payload.name,\n          links: [],\n        };\n\n        foundGroupItem.links = [...foundGroupItem.links, newGroup];\n\n        state.opens[payload.parentId] = true;\n      }\n\n      SettingModel.setValue(state);\n    },\n    newLink(state, action: PayloadAction<{ parentId: string; name: string }>) {\n      const { parentId, name } = action.payload;\n\n      traverse(state, state.groups, (item) => {\n        const temp = item;\n\n        if (item.id === parentId) {\n          if (!temp.links) temp.links = [];\n          temp.links = [\n            ...temp.links,\n            {\n              type: 'link',\n              id: `${Date.now()}`,\n              name,\n              fileLink: `/${Math.random().toString(36).substring(7)}`,\n              linkType: 'pairy',\n            },\n          ];\n\n          state.opens[parentId] = true;\n        }\n      });\n\n      SettingModel.setValue(state);\n    },\n    newLinkByCurrentPage(state, action: PayloadAction<{ parentId: string; name: string; fileLink: string }>) {\n      const { parentId, name, fileLink } = action.payload;\n\n      const foundItem = findOne(state.groups, (item) => item.id === parentId);\n\n      if (foundItem) {\n        if (!foundItem.links) foundItem.links = [];\n        foundItem.links = [\n          ...foundItem.links,\n          {\n            type: 'link',\n            id: `${Date.now()}`,\n            name,\n            fileLink,\n            linkType: 'pairy',\n          },\n        ];\n\n        state.opens[parentId] = true;\n      }\n\n      SettingModel.setValue(state);\n    },\n    copyMarkdownTextForGroup(state, action: PayloadAction<string>) {\n      const id = action.payload;\n\n      const foundItem = findOne(state.groups, (item) => item.id === id);\n\n      if (foundItem) {\n        const list: {\n          item: ItemType;\n          depth: number;\n        }[] = [\n          {\n            item: foundItem,\n            depth: 0,\n          },\n        ];\n        traverse(foundItem, foundItem.links, (item, _, depth) => {\n          list.push({ item, depth });\n        });\n\n        const text = list\n          .map((it) => {\n            const { item, depth } = it;\n            const prefix = '  '.repeat(depth);\n\n            if (item.type === 'group') {\n              return `${prefix}- ${item.name}`;\n            }\n\n            return `${prefix}- [${item.name}](${item.fileLink})`;\n          })\n          .join('\\n');\n\n        copyTextToClipboard(text);\n      }\n    },\n  },\n});\n\nexport function favoriteSelector(state: AppState): ItemType[] {\n  return (\n    state.linkState.favorite?.map((id) => {\n      if (typeof id !== 'string') {\n        return id;\n      }\n\n      return findOne(state.linkState.groups, (item) => item.id === id);\n    }) || []\n  );\n}\n\nexport function recentFavoriteSelector(count: number = 10) {\n  return (state: AppState): LinkItemType[] => {\n    return (\n      state.linkState.favorite?.map((id) => {\n        if (typeof id !== 'string') {\n          return id;\n        }\n\n        return findOne(state.linkState.groups, (item) => item.id === id);\n      }) || []\n    )\n      .filter((item) => item?.fileLink)\n      .reverse()\n      .filter((_, index) => index < count);\n  };\n}\n\nexport const {\n  refreshStorage,\n  copyMarkdownTextForGroup,\n  toggleFavorite,\n  toggleLinkOpen,\n  setLinkName,\n  updateLinkNameWithHeading,\n  newLinkByCurrentPage,\n  setLinkFileLink,\n  removeLink,\n  removeGroup,\n  newLink,\n  setLinkOpens,\n  newGroup,\n  newGroupAt,\n  newChildGroupAt,\n} = linkSlice.actions;\nexport default linkSlice.reducer;\n","import { ActorID } from 'yorkie-js-sdk';\nimport invert from 'invert-color';\nimport { Presence } from 'features/peerSlices';\n\nenum CursorStatus {\n  Deactivated = 'deactivated',\n  Activated = 'activated',\n}\n\n// REF https://github.com/FujitsuLaboratories/cattaz/blob/master/src/AppEnabledWikiEditorCodeMirror.jsx#L24\nexport default class Cursor {\n  private id: ActorID;\n\n  private username: string;\n\n  private color: string;\n\n  private height: number;\n\n  private marker?: CodeMirror.TextMarker;\n\n  private lineMarker?: CodeMirror.TextMarker;\n\n  private status: CursorStatus;\n\n  private nameRemoveTimeMap: Map<ActorID, ReturnType<typeof setTimeout>>;\n\n  private nameAnimationDelay: number;\n\n  private nameAnimationDuration: number;\n\n  private nameRemoveTime: number;\n\n  private nameHolder?: HTMLSpanElement;\n\n  private cursorHolder?: HTMLSpanElement;\n\n  constructor(id: ActorID, presence: Presence) {\n    this.id = id;\n    this.username = presence.username;\n    this.color = presence.color;\n    this.height = 0;\n    this.status = CursorStatus.Deactivated;\n\n    this.nameRemoveTimeMap = new Map();\n    this.nameAnimationDelay = 1;\n    this.nameAnimationDuration = 0.2;\n    this.nameRemoveTime = (this.nameAnimationDuration + this.nameAnimationDelay) * 1000;\n  }\n\n  updateCursor(cm: CodeMirror.Editor, cursorPos: CodeMirror.Position) {\n    this.removeCursor();\n    this.status = CursorStatus.Activated;\n    const cursorCoords = cm.cursorCoords(cursorPos);\n    this.height = cursorCoords.bottom - cursorCoords.top;\n\n    if (!this.cursorHolder) {\n      this.cursorHolder = document.createElement('span');\n      this.cursorHolder.classList.add('codePair-cursor');\n      this.cursorHolder.style.borderLeftColor = this.color;\n      this.cursorHolder.addEventListener('mouseenter', () => {\n        if (this.nameRemoveTimeMap.has(this.id)) {\n          clearTimeout(this.nameRemoveTimeMap.get(this.id)!);\n        }\n\n        if (this.nameHolder) {\n          /**\n           * nameHolder is being reused.\n           * In order to keep the name visible while the mouse is hovering,\n           * It need to delete the css class containing animation when it is mouseenter and add it when it is mouseleave.\n           */\n          this.nameHolder.classList.remove('text-remove');\n          this.cursorHolder?.appendChild(this.nameHolder);\n        }\n      });\n\n      this.cursorHolder.addEventListener('mouseleave', () => {\n        if (this.nameHolder) {\n          this.nameHolder.classList.add('text-remove');\n          this.nameHolder.style.animationDuration = `${this.nameAnimationDuration}s`;\n          this.nameHolder.style.animationDelay = `${this.nameAnimationDelay}s`;\n        }\n      });\n\n      this.nameHolder?.addEventListener('animationend', () => {\n        if (this.nameHolder?.classList.contains('text-remove')) {\n          this.nameRemoveTimeMap.delete(this.id);\n        }\n      });\n    }\n\n    this.cursorHolder.style.height = `${this.height}px`;\n    this.cursorHolder.setAttribute('data-pos', cursorCoords.top < 130 ? 'top' : 'bottom');\n    this.marker = cm.setBookmark(cursorPos, {\n      widget: this.cursorHolder,\n      insertLeft: true,\n    });\n\n    this.showCursorNameReserve(this.cursorHolder);\n  }\n\n  updateLine(cm: CodeMirror.Editor, fromPos: CodeMirror.Position, toPos: CodeMirror.Position) {\n    this.removeLine();\n    this.status = CursorStatus.Activated;\n    // Apply transparency to the background of selection.\n    const redColor = parseInt(this.color.slice(1, 3), 16);\n    const greenColor = parseInt(this.color.slice(3, 5), 16);\n    const blueColor = parseInt(this.color.slice(5, 7), 16);\n    const backgroundColor = `rgba(${redColor}, ${greenColor}, ${blueColor}, 0.15)`;\n\n    this.lineMarker = cm.getDoc().markText(fromPos, toPos, {\n      css: `background-color : ${backgroundColor};`,\n    });\n  }\n\n  // when user's cursor hover, show name\n  private showCursorNameReserve(cursorHolder: Element) {\n    if (!this.nameHolder) {\n      this.nameHolder = document.createElement('span');\n      this.nameHolder.classList.add('codePair-name');\n      this.nameHolder.textContent = this.username;\n      this.nameHolder.style.backgroundColor = this.color;\n      this.nameHolder.style.color = invert(this.color, true);\n    }\n\n    if (this.nameHolder.parentElement !== cursorHolder) {\n      cursorHolder.appendChild(this.nameHolder);\n    }\n\n    //      \n    this.nameHolder.classList.remove('text-remove');\n    this.resetRemoveNameReserve(this.nameHolder);\n  }\n\n  private resetRemoveNameReserve(nameHolder?: HTMLSpanElement) {\n    if (this.nameRemoveTimeMap.has(this.id)) {\n      clearTimeout(this.nameRemoveTimeMap.get(this.id)!);\n    }\n\n    this.removeNameReserve(nameHolder);\n  }\n\n  // After animate, It should actually be deleted it.\n  private removeNameReserve(nameHolder?: HTMLSpanElement) {\n    const timeoutId = setTimeout(() => {\n      if (nameHolder) {\n        nameHolder.classList.add('text-remove');\n        const { style } = nameHolder;\n        style.animationDuration = `${this.nameAnimationDuration}s`;\n        style.animationDelay = `${this.nameAnimationDelay}s`;\n      }\n    }, this.nameRemoveTime);\n\n    this.nameRemoveTimeMap.set(this.id, timeoutId);\n  }\n\n  removeCursor() {\n    if (this.marker) {\n      this.marker.clear();\n      this.marker = undefined;\n    }\n  }\n\n  removeLine() {\n    if (this.lineMarker) {\n      this.lineMarker.clear();\n      this.lineMarker = undefined;\n    }\n  }\n\n  clear() {\n    this.removeCursor();\n    this.removeLine();\n  }\n\n  isActive() {\n    return this.status === CursorStatus.Activated;\n  }\n}\n","import { Marpit, RenderResult } from '@marp-team/marpit';\n\nexport default class SlideView {\n  marpit: Marpit;\n\n  theme: string;\n\n  constructor(theme: string) {\n    this.marpit = new Marpit({\n      inlineSVG: true,\n    });\n    this.theme = theme;\n\n    const slideTheme = `\n    /* @theme example */\n      section {\n      background-color: #000;\n      color: #fff;\n      font-size: 30px;\n      padding: 40px;\n      margin: 10px;\n      border: 10px solid black;\n    }\n\n    h1, h2 {\n      text-align: center;\n      margin: 0;\n    }\n\n    h1 {\n      color: #fff;\n    }\n    `;\n    this.marpit.themeSet.default = this.marpit.themeSet.add(slideTheme);\n  }\n\n  public render(markdown: string): RenderResult {\n    return this.marpit.render(markdown);\n  }\n}\n","import CodeMirror from 'codemirror';\n\n// @ts-ignore-start\nCodeMirror.Vim.defineEx('shuffle', 'shuf', (cm, params) => {\n  const lineStart = params.line || cm.firstLine();\n  const lineEnd = params.lineEnd || params.line || cm.lastLine();\n  if (lineStart === lineEnd) {\n    return;\n  }\n  const curStart = new CodeMirror.Pos(lineStart, 0);\n  const curEnd = new CodeMirror.Pos(lineEnd, cm.getLine(lineEnd).length);\n  const text = cm.getRange(curStart, curEnd).split('\\n');\n  for (let i = text.length - 1; i > 0; i -= 1) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [text[i], text[j]] = [text[j], text[i]];\n  }\n  cm.replaceRange(text.join('\\n'), curStart, curEnd);\n});\n// @ts-ignore-end\n","import React, { useEffect, useMemo, useRef, useCallback, useState } from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { ActorID, DocEvent, TextChange } from 'yorkie-js-sdk';\nimport CodeMirror from 'codemirror';\nimport SimpleMDE from 'easymde';\nimport SimpleMDEReact from 'react-simplemde-editor';\n\nimport { AppState } from 'app/rootReducer';\nimport { ConnectionStatus, Presence } from 'features/peerSlices';\nimport { Theme as ThemeType } from 'features/settingSlices';\nimport { Preview, updateHeadings } from 'features/docSlices';\n\nimport { updateLinkNameWithHeading } from 'features/linkSlices';\nimport { NAVBAR_HEIGHT } from '../Editor';\nimport Cursor from './Cursor';\nimport SlideView from './slideView';\n\nimport 'easymde/dist/easymde.min.css';\nimport 'codemirror/keymap/sublime';\nimport 'codemirror/keymap/emacs';\nimport 'codemirror/keymap/vim';\nimport './codemirror/shuffle';\n\nconst WIDGET_HEIGHT = 70;\n\ninterface CodeEditorProps {\n  forwardedRef: React.MutableRefObject<CodeMirror.Editor | null>;\n}\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    dark: {\n      '& .CodeMirror': {\n        color: theme.palette.common.white,\n        borderColor: theme.palette.background.paper,\n        backgroundColor: theme.palette.background.paper,\n      },\n      '& .CodeMirror-cursor': {\n        borderLeftColor: theme.palette.common.white,\n        color: theme.palette.common.white,\n      },\n      '& .editor-toolbar': {\n        backgroundColor: '#303030',\n      },\n      '& .editor-toolbar > *': {\n        color: theme.palette.common.white,\n      },\n      '& .editor-toolbar > .active, .editor-toolbar > button:hover, .editor-preview pre, .cm-s-easymde': {\n        backgroundColor: theme.palette.background.paper,\n      },\n      '& .editor-preview': {\n        backgroundColor: theme.palette.background.default,\n      },\n\n      '& .CodeMirror-line span.cm-keyword': { color: '#f92672' },\n      '& .CodeMirror-line span.cm-atom': { color: '#ae81ff' },\n      '& .CodeMirror-line span.cm-number': { color: '#ae81ff' },\n      '& .CodeMirror-line span.cm-def': { color: '#bc9262' },\n      '& .CodeMirror-line span.cm-variable': { color: '#f8f8f2' },\n      '& .CodeMirror-line span.cm-property': { color: '#a6e22e' },\n      '& .CodeMirror-line span.cm-operator': { color: '#fff' },\n      '& .CodeMirror-line span.cm-string': { color: '#e6db74' },\n      '& .CodeMirror-line span.cm-string-2': { color: '#e6db74' },\n      '& .CodeMirror-line span.cm-meta': { color: '#555' },\n      '& .CodeMirror-line span.cm-error': { background: '#f92672', color: '#f8f8f0' },\n      '& .CodeMirror-line span.cm-qualifier': { color: '#555' },\n      '& .CodeMirror-line span.cm-builtin': { color: '#66d9ef' },\n      '& .CodeMirror-line span.cm-bracket': { color: '#f8f8f2' },\n      '& .CodeMirror-line span.cm-tag': { color: '#bc6283' },\n      '& .CodeMirror-line span.cm-attribute': { color: '#97b757' },\n      '& .CodeMirror-line span.cm-hr': { color: '#999' },\n    },\n  }),\n);\n\nexport default function CodeEditor({ forwardedRef }: CodeEditorProps) {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const doc = useSelector((state: AppState) => state.docState.doc);\n  const preview = useSelector((state: AppState) => state.docState.preview);\n  const menu = useSelector((state: AppState) => state.settingState.menu);\n  const client = useSelector((state: AppState) => state.docState.client);\n  const peers = useSelector((state: AppState) => state.peerState.peers);\n  const cursorMapRef = useRef<Map<ActorID, Cursor>>(new Map());\n  const [editor, setEditor] = useState<CodeMirror.Editor | null>(null);\n\n  const connectCursor = useCallback((clientID: ActorID, presence: Presence) => {\n    cursorMapRef.current.set(clientID, new Cursor(clientID, presence));\n  }, []);\n\n  const disconnectCursor = useCallback((clientID: ActorID) => {\n    if (cursorMapRef.current.has(clientID)) {\n      cursorMapRef.current.get(clientID)!.clear();\n      cursorMapRef.current.delete(clientID);\n    }\n  }, []);\n\n  const getCmInstanceCallback = useCallback((cm: CodeMirror.Editor) => {\n    setEditor(cm);\n  }, []);\n\n  const goHeadingLink = useCallback(() => {\n    const cm = document.querySelector('.CodeMirror');\n\n    if (cm) {\n      const { CodeMirror: cmInstance } = cm as any;\n\n      const searchText = decodeURIComponent(window.location.hash.replace('#', ''));\n      const cursor = (cmInstance as any).getSearchCursor(searchText);\n\n      if (cursor.find()) {\n        cmInstance.setCursor(cursor.from());\n        cmInstance.scrollIntoView(cursor.from());\n        cmInstance.focus();\n      }\n    }\n  }, []);\n\n  useEffect(() => {\n    for (const [id, peer] of Object.entries(peers)) {\n      if (cursorMapRef.current.has(id) && peer.status === ConnectionStatus.Disconnected) {\n        disconnectCursor(id);\n      } else if (!cursorMapRef.current.has(id) && peer.status === ConnectionStatus.Connected) {\n        connectCursor(id, peer.presence);\n      }\n    }\n  }, [peers, connectCursor, disconnectCursor]);\n\n  useEffect(() => {\n    if (!client || !doc || !editor) {\n      return;\n    }\n\n    // eslint-disable-next-line no-param-reassign\n    forwardedRef.current = editor;\n\n    const updateCursor = (clientID: ActorID, pos: CodeMirror.Position) => {\n      const cursor = cursorMapRef.current.get(clientID);\n      cursor?.updateCursor(editor, pos);\n    };\n\n    const updateLine = (clientID: ActorID, fromPos: CodeMirror.Position, toPos: CodeMirror.Position) => {\n      const cursor = cursorMapRef.current.get(clientID);\n      cursor?.updateLine(editor, fromPos, toPos);\n    };\n\n    let syncText = () => {};\n\n    doc.subscribe((event: DocEvent) => {\n      if (event.type === 'remote-change') {\n        // display remote cursors\n        for (const { change } of event.value) {\n          const actor = change.getID().getActorID()!;\n          if (actor !== client.getID()) {\n            if (!cursorMapRef.current.has(actor)) {\n              return;\n            }\n\n            const cursor = cursorMapRef.current.get(actor);\n            if (cursor!.isActive()) {\n              return;\n            }\n\n            updateCursor(actor, editor.posFromIndex(0));\n          }\n        }\n      } else if (event.type === 'snapshot') {\n        // re-sync for the new text from the snapshot\n        syncText();\n      }\n    });\n\n    editor.on('mousedown', (instance: CodeMirror.Editor, event: MouseEvent) => {\n      if (event.metaKey) {\n        const pos = editor.coordsChar({ left: event.clientX, top: event.clientY });\n        const token = editor.getTokenAt(pos);\n\n        if (token.type?.includes('link')) {\n          window.open(token.string, token.string);\n        }\n      }\n    });\n\n    editor.on('change', () => {\n      dispatch(updateHeadings());\n      dispatch(updateLinkNameWithHeading());\n    });\n\n    // local to remote\n    editor.on('beforeChange', (instance: CodeMirror.Editor, change: CodeMirror.EditorChange) => {\n      if (change.origin === 'yorkie' || change.origin === 'setValue') {\n        return;\n      }\n\n      const from = editor.indexFromPos(change.from);\n      const to = editor.indexFromPos(change.to);\n      const content = change.text.join('\\n');\n\n      doc.update((root) => {\n        root.content.edit(from, to, content);\n      });\n    });\n\n    editor.on('beforeSelectionChange', (instance: CodeMirror.Editor, data: CodeMirror.EditorSelectionChange) => {\n      if (!data.origin) {\n        return;\n      }\n\n      const from = editor.indexFromPos(data.ranges[0].anchor);\n      const to = editor.indexFromPos(data.ranges[0].head);\n\n      doc.update((root) => {\n        root.content.select(from, to);\n      });\n    });\n\n    // remote to local\n    const changeEventHandler = (changes: TextChange[]) => {\n      changes.forEach((change) => {\n        const { actor, from, to } = change;\n        if (change.type === 'content') {\n          const content = change.value?.content || '';\n          if (actor !== client.getID()) {\n            const fromPos = editor.posFromIndex(from);\n            const toPos = editor.posFromIndex(to);\n            editor.replaceRange(content, fromPos, toPos, 'yorkie');\n          }\n        } else if (change.type === 'selection') {\n          if (actor !== client.getID()) {\n            let fromPos = editor.posFromIndex(from);\n            let toPos = editor.posFromIndex(to);\n            updateCursor(actor, toPos);\n            if (from > to) {\n              [toPos, fromPos] = [fromPos, toPos];\n            }\n            updateLine(actor, fromPos, toPos);\n          }\n        }\n      });\n    };\n\n    // sync text of document and editor\n    syncText = () => {\n      const text = doc.getRoot().content;\n\n      if (text) {\n        text.onChanges(changeEventHandler);\n        editor.setValue(text.toString());\n      }\n    };\n    syncText();\n    editor.addKeyMap(menu.codeKeyMap);\n    editor.setOption('keyMap', menu.codeKeyMap);\n    editor.getDoc().clearHistory();\n    editor.focus();\n\n    // link to heading\n    goHeadingLink();\n\n    // set table of contents event\n    // When a hashchange event occurs, move inside the codemirror with location.hash.\n    window.addEventListener('hashchange', () => {\n      goHeadingLink();\n    });\n\n    window.addEventListener('popstate', () => {\n      goHeadingLink();\n    });\n\n    dispatch(updateHeadings());\n  }, [client, doc, editor, forwardedRef, menu, goHeadingLink, dispatch]);\n\n  const options = useMemo(() => {\n    const opts = {\n      spellChecker: false,\n      placeholder: 'Write code here and share...',\n      tabSize: Number(menu.tabSize),\n      maxHeight: `calc(100vh - ${NAVBAR_HEIGHT + WIDGET_HEIGHT}px)`,\n      toolbar: [\n        'bold',\n        'italic',\n        '|',\n        'unordered-list',\n        'ordered-list',\n        '|',\n        'code',\n        'link',\n        'image',\n        'table',\n        '|',\n        'side-by-side',\n        'preview',\n        'fullscreen',\n      ],\n      unorderedListStyle: '-',\n      status: false,\n      shortcuts: {\n        toggleUnorderedList: null,\n      },\n    } as SimpleMDE.Options;\n\n    if (preview === Preview.Slide) {\n      const slideView = new SlideView(menu.theme);\n      // eslint-disable-next-line func-names\n      opts.previewRender = function (markdown: string, previewElement: HTMLElement): string {\n        const { html, css } = slideView.render(markdown);\n        // @ts-ignore\n        const self = this as any;\n        setTimeout(() => {\n          if (!self.style) {\n            self.style = document.createElement('style');\n            document.head.appendChild(self.style);\n          }\n          self.style.innerHTML = css;\n\n          // eslint-disable-next-line no-param-reassign\n          previewElement.innerHTML = html;\n        }, 20);\n\n        // @ts-ignore\n        return null;\n      };\n    }\n    return opts;\n  }, [preview, menu]);\n\n  return (\n    <SimpleMDEReact\n      className={menu.theme === ThemeType.Dark ? classes.dark : ''}\n      getCodemirrorInstance={getCmInstanceCallback}\n      options={options}\n    />\n  );\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nexport enum Color {\n  Red = '#d8453c',\n  Blue = '#19abbf',\n  Green = '#699e3d',\n  White = '#cccccc',\n  Yellow = '#f3b328',\n  Black = '#444',\n}\n\nexport enum ToolType {\n  None,\n  Line,\n  Eraser,\n  Rect,\n  Selector,\n  Clear,\n  Settings,\n}\n\nexport interface BoardState {\n  isOpen: boolean;\n\n  color: Color;\n  toolType: ToolType;\n}\n\nconst initialBoardState: BoardState = {\n  isOpen: false,\n  color: Color.Yellow,\n  toolType: ToolType.None,\n};\n\nconst boardSlice = createSlice({\n  name: 'board',\n  initialState: initialBoardState,\n\n  reducers: {\n    toggleBoard(state) {\n      state.isOpen = !state.isOpen;\n    },\n\n    setTool(state, action: PayloadAction<ToolType>) {\n      state.toolType = action.payload;\n    },\n\n    setColor(state, action: PayloadAction<Color>) {\n      state.color = action.payload;\n    },\n  },\n});\n\nexport const { toggleBoard, setTool, setColor } = boardSlice.actions;\nexport default boardSlice.reducer;\n","/* eslint-disable max-classes-per-file */\nclass Event {\n  private name: string;\n\n  callbacks: Array<Function>;\n\n  constructor(name: string) {\n    this.name = name;\n    this.callbacks = [];\n  }\n\n  on(cb: Function) {\n    this.callbacks.push(cb);\n  }\n\n  off(cb: Function) {\n    const idx = this.callbacks.findIndex((callback) => callback === cb);\n    this.callbacks.splice(idx, 1);\n  }\n\n  toString() {\n    return this.name;\n  }\n}\n\nexport default class EventDispatcher {\n  events: { [name: string]: Event };\n\n  constructor() {\n    this.events = {};\n  }\n\n  emit(name: string, ...args: Array<unknown>) {\n    if (!this.events[name]) {\n      return;\n    }\n\n    this.events[name].callbacks.forEach((cb) => {\n      cb(...args);\n    });\n  }\n\n  addEventListener(name: string, cb: Function): void {\n    if (!this.events[name]) {\n      this.events[name] = new Event(name);\n    }\n\n    this.events[name].on(cb);\n  }\n\n  removeEventListener(name: string, cb?: Function) {\n    if (!cb) {\n      delete this.events[name];\n      return;\n    }\n\n    this.events[name].off(cb);\n  }\n}\n","export default class CanvasWrapper {\n  private canvas: HTMLCanvasElement;\n\n  // eslint-disable-next-line react/static-property-placement\n  private context: CanvasRenderingContext2D;\n\n  private width = 0;\n\n  private height = 0;\n\n  constructor(canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n    this.context = canvas.getContext('2d')!;\n\n    this.context.lineWidth = 3;\n    this.context.lineCap = 'round';\n    this.canvas.className = 'canvas';\n\n    this.setWidth(canvas.width);\n    this.setHeight(canvas.height);\n  }\n\n  getCanvas() {\n    return this.canvas;\n  }\n\n  getContext() {\n    return this.context;\n  }\n\n  getWidth() {\n    return this.width;\n  }\n\n  getHeight() {\n    return this.height;\n  }\n\n  setWidth(width: number, devicePixelRatio?: number) {\n    this.width = width;\n    this.canvas.width = devicePixelRatio ? width * devicePixelRatio : width;\n    this.canvas.style.width = `${width}px`;\n  }\n\n  setHeight(height: number, devicePixelRatio?: number) {\n    this.height = height;\n    this.canvas.height = devicePixelRatio ? height * devicePixelRatio : height;\n    this.canvas.style.height = `${height}px`;\n  }\n\n  setSize(width: number, height: number, devicePixelRatio?: number) {\n    this.setWidth(width, devicePixelRatio);\n    this.setHeight(height, devicePixelRatio);\n  }\n\n  clear() {\n    this.getContext().clearRect(0, 0, this.getWidth(), this.getHeight());\n  }\n\n  resize() {\n    const { devicePixelRatio } = window;\n    if (devicePixelRatio) {\n      this.setSize(this.width, this.height, devicePixelRatio);\n      this.context.scale(devicePixelRatio, devicePixelRatio);\n    } else {\n      this.setSize(this.width, this.height);\n    }\n  }\n}\n","import { Color } from 'features/boardSlices';\nimport fitCurve from 'fit-curve';\nimport { Line, Point, EraserLine } from 'features/docSlices';\n\ntype CanvasLine = Pick<Line, 'type' | 'points' | 'color'>;\n\ntype CanvasEraser = Pick<EraserLine, 'type' | 'points'>;\n\n/**\n * Create the basic object of the line with point.\n */\nexport function createLine(point: Point, color: Color): Line {\n  return {\n    type: 'line',\n    color,\n    points: [point],\n  } as Line;\n}\n\n/**\n * Create the basic object of the line with point.\n */\nexport function createEraserLine(point: Point): EraserLine {\n  return {\n    type: 'eraser',\n    points: [point],\n  } as EraserLine;\n}\n\n/**\n * drawTrace draws a trace of the line\n */\nexport function drawTrace(context: CanvasRenderingContext2D, line: CanvasLine) {\n  const { points, color } = line;\n  context.strokeStyle = color;\n  context.beginPath();\n  context.moveTo(points[0].x, points[0].y);\n  for (let i = 1; i < points.length; i += 1) {\n    context.lineTo(points[i].x, points[i].y);\n  }\n  context.stroke();\n}\n\n/**\n * drawLine draws a line with bezier curves.\n */\nexport function drawLine(context: CanvasRenderingContext2D, line: CanvasLine) {\n  let points: number[][] = [];\n  for (const p of line.points) {\n    points.push([p.x, p.y]);\n  }\n\n  if (points.length <= 100) {\n    points = points\n      .map((p, index) => {\n        if (index > 0) {\n          const prevP = points[index - 1];\n          const currentP = p;\n\n          // how to create 10 points between two points\n          const diffX = (currentP[0] - prevP[0]) / 10;\n          const diffY = (currentP[1] - prevP[1]) / 10;\n\n          const newPoints = [];\n          for (let i = 1; i < 10; i += 1) {\n            newPoints.push([prevP[0] + diffX * i, prevP[1] + diffY * i]);\n          }\n\n          return newPoints;\n        }\n\n        return [];\n      })\n      .flat();\n  }\n\n  const curves = fitCurve(points, 3);\n  if (!curves.length) {\n    return;\n  }\n\n  context.save();\n  context.beginPath();\n  context.strokeStyle = line.color || '#ff7043';\n\n  const firstCurve = curves[0];\n  context.moveTo(firstCurve[0][0], firstCurve[0][1]);\n\n  for (const curve of curves) {\n    context.bezierCurveTo(curve[1][0], curve[1][1], curve[2][0], curve[2][1], curve[3][0], curve[3][1]);\n  }\n\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\n/**\n * drawEraser draws the line of the eraser on the canvas.\n */\nexport function drawEraser(context: CanvasRenderingContext2D, line: CanvasEraser) {\n  context.save();\n  context.beginPath();\n\n  context.strokeStyle = '#ff7043';\n\n  let isMoved = false;\n  for (const p of line.points) {\n    if (isMoved === false) {\n      isMoved = true;\n      context.moveTo(p.x, p.y);\n    } else {\n      context.lineTo(p.x, p.y);\n    }\n  }\n  context.stroke();\n  context.closePath();\n  context.restore();\n}\n\n/**\n * Match the mouse point position for eraser\n */\nexport function fixEraserPoint(point: Point) {\n  const eraserOffsetXSize = 8;\n  const eraserOffsetYSize = 6;\n  return {\n    y: point.y + eraserOffsetXSize,\n    x: point.x + eraserOffsetYSize,\n  };\n}\n","import { Point, Box, Shape, Rect } from 'features/docSlices';\n\n/**\n * square distance between 2 points\n */\nfunction getSqDist(p1: Point, p2: Point) {\n  const dx = p1.x - p2.x;\n  const dy = p1.y - p2.y;\n\n  return dx * dx + dy * dy;\n}\n\n/**\n * square distance from a point to a segment\n */\nfunction getSqSegDist(p: Point, p1: Point, p2: Point) {\n  let { x, y } = p1;\n  let dx = p2.x - x;\n  let dy = p2.y - y;\n\n  if (dx !== 0 || dy !== 0) {\n    const t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x = p2.x;\n      y = p2.y;\n    } else if (t > 0) {\n      x += dx * t;\n      y += dy * t;\n    }\n  }\n\n  dx = p.x - x;\n  dy = p.y - y;\n  return dx * dx + dy * dy;\n}\n\nfunction douglasPeuckerStep(\n  points: Array<Point>,\n  first: number,\n  last: number,\n  tolerance: number,\n  simplified: Array<Point>,\n) {\n  let maxDist = tolerance;\n  let index = 0;\n\n  for (let i = first + 1; i < last; i += 1) {\n    const dist = getSqSegDist(points[i], points[first], points[last]);\n\n    if (dist > maxDist) {\n      index = i;\n      maxDist = dist;\n    }\n  }\n\n  if (maxDist > tolerance) {\n    if (first + 1 < index) {\n      douglasPeuckerStep(points, first, index, tolerance, simplified);\n    }\n    simplified.push(points[index]);\n    if (index + 1 < last) {\n      douglasPeuckerStep(points, index, last, tolerance, simplified);\n    }\n  }\n}\n\nfunction douglasPeucker(points: Array<Point>, tolerance: number): Array<Point> {\n  const first = 0;\n  const last = points.length - 1;\n  const simplified = [];\n\n  simplified.push(points[first]);\n  douglasPeuckerStep(points, first, last, tolerance, simplified);\n  simplified.push(points[last]);\n\n  return simplified;\n}\n\nfunction simplifyRadialDist(points: Array<Point>, tolerance: number) {\n  let point = points[0];\n  let prevPoint = point;\n  const simplified = [prevPoint];\n\n  for (let i = 1, len = points.length; i < len; i += 1) {\n    point = points[i];\n\n    if (getSqDist(point, prevPoint) > tolerance) {\n      simplified.push(point);\n      prevPoint = point;\n    }\n  }\n\n  if (prevPoint !== point) {\n    simplified.push(point);\n  }\n  return simplified;\n}\n\n/**\n * @see {@link https://cartography-playground.gitlab.io/playgrounds/douglas-peucker-algorithm/}\n * @see {@link https://github.com/mourner/simplify-js}\n */\nexport function compressPoints(points: Array<Point>, tolerance: number = 10): Array<Point> {\n  return douglasPeucker(simplifyRadialDist(points, tolerance), tolerance);\n}\n\n/**\n * Check if the two lines overlap\n * @see {@link http://jsfiddle.net/justin_c_rounds/Gd2S2/}\n * @see {@link https://en.wikipedia.org/wiki/Line%E2%80%93line_intersection}\n */\nexport function checkLineIntersection(point1Start: Point, point1End: Point, point2Start: Point, point2End: Point) {\n  // if the lines intersect, the result contains the x and y of the intersection (treating the lines as infinite) and booleans for whether line segment 1 or line segment 2 contain the point\n  let a;\n  let b;\n  const result = {\n    x: 0,\n    y: 0,\n    onLine1: false,\n    onLine2: false,\n  };\n\n  const denominator =\n    (point2End.y - point2Start.y) * (point1End.x - point1Start.x) -\n    (point2End.x - point2Start.x) * (point1End.y - point1Start.y);\n  if (denominator === 0) {\n    return result;\n  }\n  a = point1Start.y - point2Start.y;\n  b = point1Start.x - point2Start.x;\n  const numerator1 = (point2End.x - point2Start.x) * a - (point2End.y - point2Start.y) * b;\n  const numerator2 = (point1End.x - point1Start.x) * a - (point1End.y - point1Start.y) * b;\n  a = numerator1 / denominator;\n  b = numerator2 / denominator;\n\n  // if we cast these lines infinitely in both directions, they intersect here:\n  result.x = point1Start.x + a * (point1End.x - point1Start.x);\n  result.y = point1Start.y + a * (point1End.y - point1Start.y);\n  /*\n  // it is worth noting that this should be the same as:\n  x = point2Start.x + (b * (point2End.x - point2Start.x));\n  y = point2Start.x + (b * (point2End.y - point2Start.y));\n  */\n  // if line1 is a segment and line2 is infinite, they intersect if:\n  if (a > 0 && a < 1) {\n    result.onLine1 = true;\n  }\n  // if line2 is a segment and line1 is infinite, they intersect if:\n  if (b > 0 && b < 1) {\n    result.onLine2 = true;\n  }\n  // if line1 and line2 are segments, they intersect if both of the above are true\n  return result;\n}\n\nexport function cloneBox(box: Box): Box {\n  return {\n    y: box.y,\n    x: box.x,\n    width: box.width,\n    height: box.height,\n  };\n}\n\n/**\n * Check if the point is contained inside the box.\n */\nexport function isInnerBox(box: Box, point: Point): boolean {\n  const offsetY = box.y + box.height;\n  const offsetX = box.x + box.width;\n\n  if (box.height > 0 ? offsetY < point.y : offsetY > point.y) {\n    return false;\n  }\n  if (box.y > point.y) {\n    return false;\n  }\n\n  if (box.height > 0 ? offsetX < point.x : offsetX > point.x) {\n    return false;\n  }\n  if (box.x > point.x) {\n    return false;\n  }\n  return true;\n}\n\n/**\n * Check if it is a shape that can be selected.\n */\nexport function isSelectable(shape: Shape): shape is Rect {\n  return shape.type === 'rect';\n}\n","import { Rect, Point, Box } from 'features/docSlices';\nimport { Color } from 'features/boardSlices';\nimport { cloneBox } from './utils';\n\nexport interface RectOptions {\n  color: Color;\n}\n\ntype CanvasRect = Pick<Rect, 'type' | 'color' | 'box'>;\n\n/**\n * Create the basic object of the rect with point.\n */\nexport function createRect(point: Point, options: RectOptions): Rect {\n  return {\n    type: 'rect',\n    color: options.color,\n    box: {\n      x: point.x,\n      y: point.y,\n      width: 0,\n      height: 0,\n    },\n    points: [{ x: point.x, y: point.y }],\n  } as Rect;\n}\n\n/**\n * Draw a rect on the canvas.\n */\nexport function drawRect(context: CanvasRenderingContext2D, rect: CanvasRect) {\n  context.save();\n  context.strokeStyle = rect.color;\n  context.strokeRect(rect.box.x, rect.box.y, rect.box.width, rect.box.height);\n  context.restore();\n}\n\n/**\n * Adjust the box according to the incoming point.\n */\nexport function adjustRectBox(shape: Rect, point: Point): Box {\n  const box = cloneBox(shape.box);\n  const rectPoint = shape.points[0];\n\n  const width = point.x - rectPoint.x;\n  const height = point.y - rectPoint.y;\n  const aWidth = Math.abs(width);\n  const aHeight = Math.abs(height);\n\n  box.x = rectPoint.x - (width > 0 ? 0 : -width);\n  box.y = rectPoint.y - (height > 0 ? 0 : -height);\n  box.width = aWidth;\n  box.height = aHeight;\n\n  return box;\n}\n","export function addEvent(el: EventTarget, type: string, fn: EventListener, capturing?: boolean) {\n  return el.addEventListener(type, fn, capturing);\n}\n\nexport function removeEvent(el: EventTarget, type: string, fn: EventListener, capturing?: boolean) {\n  return el.removeEventListener(type, fn, capturing);\n}\n\nconst touch = {\n  mouseup: 'touchend',\n  mouseout: 'touchend',\n  mousedown: 'touchstart',\n  mousemove: 'touchmove',\n};\n\ntype MouseType = 'mouseup' | 'mouseout' | 'mousedown' | 'mousemove';\n\nexport type TouchyEvent = MouseEvent & TouchEvent;\n\n/**\n * {@linkcode https://github.com/bevacqua/dragula/blob/e0bcdc72ae8e0b85e17f154957bdd0cc2e2e35db/dragula.js#L498}\n */\nexport function touchy(el: EventTarget, event: Function, type: MouseType, fn: (evt: TouchyEvent) => void) {\n  event(el, touch[type], fn);\n  event(el, type, fn);\n}\n","import { Point } from 'features/docSlices';\n\nexport type Task = Point;\n\nconst INTERVAL_TIME = 50;\nlet tasks: Array<Task> = [];\nlet timeout: ReturnType<typeof setTimeout>;\nlet work: Function | undefined;\n\nconst doWork = () => {\n  if (typeof work === 'function') {\n    work(tasks);\n    tasks = [];\n  }\n};\n\nfunction requestTask(isDone: Boolean) {\n  if (isDone) {\n    doWork();\n    return;\n  }\n\n  timeout = setTimeout(() => {\n    doWork();\n    requestTask(false);\n  }, INTERVAL_TIME);\n}\n\nexport function reserveTask(task: Task, _work: Function) {\n  tasks.push(task);\n\n  if (work === undefined) {\n    work = _work;\n    requestTask(false);\n  }\n}\n\nexport function flushTask() {\n  clearTimeout(timeout);\n\n  if (typeof work === 'function') {\n    requestTask(true);\n  }\n  work = undefined;\n}\n","import { TimeTicket } from 'yorkie-js-sdk';\nimport { ToolType, Color } from 'features/boardSlices';\nimport { Root, Shape, Point, Line, Rect } from 'features/docSlices';\n\nexport type Options = { color: Color };\n\nexport type BoardPresence = {\n  eraserPoints?: Point[];\n  line?: Omit<Line, 'getID'>;\n  rect?: Omit<Rect, 'getID'>;\n};\n\nexport type MouseDownCallback = (boardPresence: BoardPresence) => void;\n\nexport type MouseMoveCallback = (boardPresence: BoardPresence) => void;\n\nexport type MouseUpCallback = (boardPresence: BoardPresence) => void;\n\nabstract class Worker {\n  constructor(options?: Options) {\n    this.options = options;\n  }\n\n  options?: Options;\n\n  abstract type: ToolType;\n\n  abstract update: Function;\n\n  abstract mousedown(point: Point, callback?: MouseDownCallback): void;\n\n  abstract mousemove(point: Point, callback?: MouseMoveCallback): void;\n\n  abstract mouseup(callback?: MouseUpCallback): void;\n\n  abstract flushTask(): void;\n\n  getElementByID(root: Root, createID: TimeTicket): Shape | undefined {\n    return root.shapes.getElementByID(createID);\n  }\n\n  deleteByID(root: Root, createID: TimeTicket): Shape | undefined {\n    return root.shapes.deleteByID(createID);\n  }\n\n  clearAll() {\n    this.update((root: Root) => {\n      for (const shape of root.shapes) {\n        this.deleteByID(root, shape.getID());\n      }\n    });\n  }\n\n  setOption(options: Options) {\n    this.options = {\n      ...this.options,\n      ...options,\n    };\n  }\n}\n\nexport default Worker;\n","import { TimeTicket } from 'yorkie-js-sdk';\nimport { Root, Point, Line } from 'features/docSlices';\nimport { ToolType } from 'features/boardSlices';\nimport Board from 'components/Editor/DrawingBoard/Canvas/Board';\nimport { createLine } from '../line';\nimport Worker, { MouseMoveCallback, MouseUpCallback, Options } from './Worker';\nimport { compressPoints } from '../utils';\n\nclass LineWorker extends Worker {\n  type = ToolType.Line;\n\n  update: Function;\n\n  board: Board;\n\n  private createID?: TimeTicket;\n\n  private previewLine: Omit<Line, 'getID'>;\n\n  constructor(update: Function, board: Board, options: Options) {\n    super(options);\n    this.update = update;\n    this.board = board;\n    this.previewLine = {\n      type: 'line',\n      color: this.options!.color,\n      points: [],\n    };\n  }\n\n  mousedown(point: Point): void {\n    this.previewLine = createLine(point, this.options?.color!);\n  }\n\n  mousemove(point: Point, callback: MouseMoveCallback) {\n    this.previewLine.points.push(point);\n    callback({ line: { ...this.previewLine } });\n  }\n\n  mouseup(callback: MouseUpCallback) {\n    this.flushTask();\n    this.previewLine = { ...this.previewLine, points: [] };\n    callback({});\n  }\n\n  flushTask() {\n    if (this.previewLine.points.length > 0) {\n      this.update((root: Root) => {\n        this.previewLine.points = compressPoints(this.previewLine.points);\n        root.shapes.push(this.previewLine as Line);\n\n        const lastShape = root.shapes.getLast();\n        this.createID = lastShape.getID();\n        this.board.drawAll(root.shapes);\n      });\n    }\n  }\n}\n\nexport default LineWorker;\n","import { TimeTicket } from 'yorkie-js-sdk';\nimport { Root, Point, Rect } from 'features/docSlices';\nimport { ToolType } from 'features/boardSlices';\nimport Board from 'components/Editor/DrawingBoard/Canvas/Board';\nimport { createRect, adjustRectBox } from '../rect';\nimport Worker, { MouseMoveCallback, MouseUpCallback, Options } from './Worker';\n\nclass RectWorker extends Worker {\n  type = ToolType.Rect;\n\n  update: Function;\n\n  board: Board;\n\n  private createID?: TimeTicket;\n\n  private previewRect: Omit<Rect, 'getID'>;\n\n  constructor(update: Function, board: Board, options: Options) {\n    super(options);\n    this.update = update;\n    this.board = board;\n    this.previewRect = {\n      type: 'rect',\n      color: this.options!.color,\n      box: {\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n      },\n      points: [],\n    };\n  }\n\n  mousedown(point: Point): void {\n    this.previewRect = createRect(point, this.options!);\n  }\n\n  mousemove(point: Point, callback: MouseMoveCallback) {\n    const box = adjustRectBox(this.previewRect as Rect, point);\n    this.previewRect.box = box;\n    callback({ rect: { ...this.previewRect } });\n  }\n\n  mouseup(callback: MouseUpCallback) {\n    this.flushTask();\n    this.previewRect = { ...this.previewRect, box: { x: 0, y: 0, height: 0, width: 0 }, points: [] };\n    callback({});\n  }\n\n  flushTask() {\n    if (this.previewRect.box.width !== 0 && this.previewRect.box.height !== 0) {\n      this.update((root: Root) => {\n        root.shapes.push(this.previewRect as Rect);\n\n        const lastShape = root.shapes.getLast();\n        this.createID = lastShape.getID();\n        this.board.drawAll(root.shapes);\n      });\n    }\n  }\n}\n\nexport default RectWorker;\n","import { ToolType, Color } from 'features/boardSlices';\nimport { Point, Shape } from 'features/docSlices';\nimport EventDispatcher from 'utils/eventDispatcher';\nimport { Presence } from 'features/peerSlices';\n\nimport CanvasWrapper from './CanvasWrapper';\nimport { drawLine, drawEraser, drawTrace } from './line';\nimport { drawRect } from './rect';\nimport { addEvent, removeEvent, touchy, TouchyEvent } from './dom';\nimport { Worker, NoneWorker, LineWorker, EraserWorker, RectWorker, SelectorWorker, BoardPresence } from './Worker';\n\nenum DragStatus {\n  Drag,\n  Stop,\n}\n\nexport default class Board extends EventDispatcher {\n  private offsetY: number = 0;\n\n  private offsetX: number = 0;\n\n  private color: Color = Color.Black;\n\n  private dragStatus: DragStatus = DragStatus.Stop;\n\n  private lowerWrapper: CanvasWrapper;\n\n  private upperWrapper: CanvasWrapper;\n\n  private presenceMap: Map<string, BoardPresence> = new Map();\n\n  update: Function;\n\n  worker!: Worker;\n\n  constructor(el: HTMLCanvasElement, update: Function) {\n    super();\n    this.lowerWrapper = new CanvasWrapper(el);\n    this.upperWrapper = this.createUpperWrapper();\n\n    this.update = update;\n\n    this.initialize();\n  }\n\n  initialize() {\n    this.initializeSize();\n    this.initializeOffset();\n    this.emit = this.emit.bind(this);\n    this.drawAll = this.drawAll.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.onMouseOut = this.onMouseOut.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n\n    this.worker = new NoneWorker(this.update, this);\n\n    touchy(this.upperWrapper.getCanvas(), addEvent, 'mouseup', this.onMouseUp);\n    touchy(this.upperWrapper.getCanvas(), addEvent, 'mouseout', this.onMouseOut);\n    touchy(this.upperWrapper.getCanvas(), addEvent, 'mousedown', this.onMouseDown);\n\n    this.addEventListener('renderAll', this.drawAll);\n  }\n\n  destroy() {\n    touchy(this.upperWrapper.getCanvas(), removeEvent, 'mouseup', this.onMouseUp);\n    touchy(this.upperWrapper.getCanvas(), removeEvent, 'mouseout', this.onMouseOut);\n    touchy(this.upperWrapper.getCanvas(), removeEvent, 'mousedown', this.onMouseDown);\n\n    this.destroyUpperCanvas();\n    this.removeEventListener('renderAll');\n  }\n\n  initializeOffset() {\n    const { y, x } = this.lowerWrapper.getCanvas().getBoundingClientRect();\n    this.offsetY = y;\n    this.offsetX = x;\n  }\n\n  initializeSize() {\n    this.lowerWrapper.resize();\n    this.upperWrapper.resize();\n  }\n\n  createUpperWrapper(): CanvasWrapper {\n    const canvas = document.createElement('canvas');\n    const wrapper = new CanvasWrapper(canvas);\n\n    wrapper.setWidth(this.lowerWrapper.getWidth());\n    wrapper.setHeight(this.lowerWrapper.getHeight());\n\n    this.lowerWrapper.getCanvas().parentNode?.appendChild(canvas);\n\n    return wrapper;\n  }\n\n  destroyUpperCanvas() {\n    const upperCanvas = this.upperWrapper?.getCanvas();\n\n    if (upperCanvas) {\n      upperCanvas.parentNode?.removeChild(upperCanvas);\n    }\n  }\n\n  setColor(color: Color) {\n    this.color = color;\n    this.worker.setOption({ color });\n  }\n\n  setWidth(width: number) {\n    this.lowerWrapper.setWidth(width);\n    this.upperWrapper.setWidth(width);\n    this.resize();\n  }\n\n  setHeight(height: number) {\n    this.lowerWrapper.setHeight(height);\n    this.upperWrapper.setHeight(height);\n    this.resize();\n  }\n\n  resize() {\n    this.lowerWrapper.resize();\n    this.upperWrapper.resize();\n  }\n\n  setTool(tool: ToolType) {\n    this.setMouseClass(tool);\n\n    if (this.worker.type === tool) {\n      return;\n    }\n\n    this.worker.flushTask();\n    this.worker = this.createWorker(tool);\n  }\n\n  createWorker(tool: ToolType) {\n    if (tool === ToolType.Line) {\n      return new LineWorker(this.update, this, { color: this.color });\n    }\n    if (tool === ToolType.Eraser) {\n      return new EraserWorker(this.update, this);\n    }\n    if (tool === ToolType.Rect) {\n      return new RectWorker(this.update, this, { color: this.color });\n    }\n    if (tool === ToolType.Selector) {\n      return new SelectorWorker(this.update, this);\n    }\n    if (tool === ToolType.None || tool === ToolType.Clear || tool === ToolType.Settings) {\n      return new NoneWorker(this.update, this);\n    }\n    throw new TypeError(`Undefined tool: ${tool}`);\n  }\n\n  setMouseClass(tool: ToolType) {\n    this.upperWrapper.getCanvas().className = 'canvas canvas-upper';\n\n    if (tool === ToolType.Line || tool === ToolType.Rect) {\n      this.upperWrapper.getCanvas().classList.add('crosshair', 'canvas-touch-none');\n    } else if (tool === ToolType.Eraser) {\n      this.upperWrapper.getCanvas().classList.add('eraser', 'canvas-touch-none');\n    } else if (tool === ToolType.Selector) {\n      this.upperWrapper.getCanvas().classList.add('canvas-touch-none');\n    }\n  }\n\n  getPointFromTouchyEvent(evt: TouchyEvent): Point {\n    let originY;\n    let originX;\n    if (window.TouchEvent && evt instanceof TouchEvent) {\n      originY = evt.touches[0].clientY;\n      originX = evt.touches[0].clientX;\n    } else {\n      originY = evt.clientY;\n      originX = evt.clientX;\n    }\n    originY += window.scrollY;\n    originX += window.scrollX;\n    return {\n      y: originY - this.offsetY,\n      x: originX - this.offsetX,\n    };\n  }\n\n  onMouseDown(evt: TouchyEvent) {\n    touchy(this.upperWrapper.getCanvas(), addEvent, 'mousemove', this.onMouseMove);\n    this.dragStatus = DragStatus.Drag;\n\n    const point = this.getPointFromTouchyEvent(evt);\n\n    this.worker.mousedown(point, (boardPresence: BoardPresence) => {\n      this.emit('mousedown', boardPresence);\n    });\n  }\n\n  onMouseMove(evt: TouchyEvent) {\n    const point = this.getPointFromTouchyEvent(evt);\n    if (this.isOutside(point)) {\n      this.onMouseUp();\n      return;\n    }\n\n    if (this.dragStatus === DragStatus.Stop) {\n      return;\n    }\n\n    this.worker.mousemove(point, (boardPresence: BoardPresence) => {\n      this.emit('mousemove', boardPresence);\n    });\n  }\n\n  onMouseUp() {\n    touchy(this.upperWrapper.getCanvas(), removeEvent, 'mousemove', this.onMouseMove);\n    this.dragStatus = DragStatus.Stop;\n\n    this.worker.mouseup((boardPresence: BoardPresence) => {\n      this.emit('mousedown', boardPresence);\n    });\n    this.emit('mouseup');\n  }\n\n  onMouseOut() {\n    this.dragStatus = DragStatus.Stop;\n    this.worker.flushTask();\n    this.emit('mouseout');\n  }\n\n  updatePresence(peerKey: string, presence: Presence) {\n    this.clear(this.upperWrapper);\n\n    this.presenceMap.set(peerKey, JSON.parse(presence.board || '{}'));\n\n    for (const boardPresence of this.presenceMap.values()) {\n      const { eraserPoints, line, rect } = boardPresence;\n      if (eraserPoints && eraserPoints.length > 0) {\n        drawEraser(this.upperWrapper.getContext(), {\n          type: 'eraser',\n          points: eraserPoints,\n        });\n      }\n      if (line && line.points.length > 0) {\n        drawTrace(this.upperWrapper.getContext(), line);\n      }\n      if (rect && rect.box.height !== 0 && rect.box.width !== 0) {\n        drawRect(this.upperWrapper.getContext(), rect);\n      }\n    }\n  }\n\n  isOutside(point: Point): boolean {\n    if (\n      point.y < 0 ||\n      point.x < 0 ||\n      point.y > this.lowerWrapper.getHeight() ||\n      point.x > this.lowerWrapper.getWidth()\n    ) {\n      return true;\n    }\n    return false;\n  }\n\n  drawAll(shapes: Array<Shape>, wrapper: CanvasWrapper = this.lowerWrapper) {\n    this.clear(wrapper);\n    for (const shape of shapes) {\n      if (shape.type === 'line') {\n        drawLine(wrapper.getContext(), shape);\n      } else if (shape.type === 'eraser') {\n        drawEraser(wrapper.getContext(), shape);\n      } else if (shape.type === 'rect') {\n        drawRect(wrapper.getContext(), shape);\n      }\n    }\n  }\n\n  clear(wrapper: CanvasWrapper = this.lowerWrapper) {\n    wrapper.clear();\n  }\n\n  clearBoard() {\n    this.clear(this.lowerWrapper);\n    this.clear(this.upperWrapper);\n    this.worker.clearAll();\n  }\n}\n","import { Root, Point, Box } from 'features/docSlices';\nimport { ToolType } from 'features/boardSlices';\nimport Board from 'components/Editor/DrawingBoard/Canvas/Board';\nimport { fixEraserPoint } from '../line';\nimport Worker, { MouseDownCallback, MouseMoveCallback, MouseUpCallback } from './Worker';\nimport { compressPoints, checkLineIntersection, isInnerBox, isSelectable } from '../utils';\nimport * as scheduler from '../scheduler';\n\nclass EraserWorker extends Worker {\n  type = ToolType.Eraser;\n\n  update: Function;\n\n  board: Board;\n\n  private eraserBoxSize: number = 24;\n\n  private selectPoint: Point[] = [];\n\n  constructor(update: Function, board: Board) {\n    super();\n    this.update = update;\n    this.board = board;\n  }\n\n  mousedown(point: Point, callback: MouseDownCallback): void {\n    this.selectPoint = [point, point];\n\n    callback({ eraserPoints: [...this.selectPoint] });\n  }\n\n  mousemove(point: Point, callback: MouseMoveCallback) {\n    scheduler.reserveTask(point, (tasks: Array<scheduler.Task>) => {\n      const points = compressPoints(tasks);\n\n      if (tasks.length < 2) {\n        return;\n      }\n\n      this.update((root: Root) => {\n        const pointStart = fixEraserPoint(points[0]);\n        const pointEnd = fixEraserPoint(points[points.length - 1]);\n\n        const findAndRemoveShape = (point1: Point, point2: Point) => {\n          for (const shape of root.shapes) {\n            if (shape.type === 'eraser') {\n              continue;\n            }\n\n            if (isSelectable(shape)) {\n              if (isInnerBox(shape.box, point2)) {\n                this.deleteByID(root, shape.getID());\n              }\n            } else {\n              for (let i = 1; i < shape.points.length; i += 1) {\n                const shapePoint1 = shape.points[i - 1];\n                const shapePoint2 = shape.points[i];\n\n                if (isInnerBox(this.eraserBox(point2), shapePoint2)) {\n                  this.deleteByID(root, shape.getID());\n                  break;\n                }\n\n                if (isInnerBox(this.eraserBox(point1), shapePoint2)) {\n                  this.deleteByID(root, shape.getID());\n                  break;\n                }\n\n                const result = checkLineIntersection(point1, point2, shapePoint1, shapePoint2);\n                if (result.onLine1 && result.onLine2) {\n                  this.deleteByID(root, shape.getID());\n                  break;\n                }\n              }\n            }\n          }\n        };\n\n        if (this.selectPoint.length > 0) {\n          const lastPoint = this.selectPoint[this.selectPoint.length - 1];\n          findAndRemoveShape(lastPoint, pointStart);\n        }\n\n        findAndRemoveShape(pointStart, pointEnd);\n\n        this.board.drawAll(root.shapes);\n        this.selectPoint = [pointStart, pointEnd];\n\n        callback({ eraserPoints: [...this.selectPoint] });\n      });\n    });\n  }\n\n  mouseup(callback: MouseUpCallback) {\n    this.flushTask();\n    callback({});\n  }\n\n  flushTask() {\n    scheduler.flushTask();\n    this.selectPoint = [];\n  }\n\n  eraserBox(point: Point): Box {\n    const x = point.x - this.eraserBoxSize / 2;\n    const y = point.y - this.eraserBoxSize / 2;\n    const width = this.eraserBoxSize;\n    const height = this.eraserBoxSize;\n\n    return { y, x, width, height };\n  }\n}\n\nexport default EraserWorker;\n","import { Root, Point, Shape } from 'features/docSlices';\nimport { ToolType } from 'features/boardSlices';\nimport Board from 'components/Editor/DrawingBoard/Canvas/Board';\nimport { isInnerBox, cloneBox, isSelectable } from '../utils';\nimport Worker from './Worker';\nimport * as scheduler from '../scheduler';\n\nclass SelectorWorker extends Worker {\n  type = ToolType.Selector;\n\n  update: Function;\n\n  board: Board;\n\n  private selectedShape?: { shape: Shape; point: Point };\n\n  constructor(update: Function, board: Board) {\n    super();\n    this.update = update;\n    this.board = board;\n  }\n\n  mousedown(point: Point): void {\n    const target = this.findTarget(point);\n    if (target) {\n      this.selectedShape = {\n        shape: target,\n        point,\n      };\n      return;\n    }\n\n    this.selectedShape = undefined;\n  }\n\n  mousemove(point: Point) {\n    scheduler.reserveTask(point, (tasks: Array<scheduler.Task>) => {\n      if (tasks.length < 2) {\n        return;\n      }\n\n      this.update((root: Root) => {\n        if (this.isEmptySelectedShape()) {\n          return;\n        }\n\n        const lastShape = this.getElementByID(root, this.selectedShape!.shape.getID());\n        if (!lastShape || lastShape.type !== 'rect') {\n          return;\n        }\n\n        if (isSelectable(lastShape)) {\n          const pointEnd = tasks[tasks.length - 1];\n          const offsetY = pointEnd.y - this.selectedShape!.point.y;\n          const offsetX = pointEnd.x - this.selectedShape!.point.x;\n          this.selectedShape!.point = pointEnd;\n\n          lastShape.box = {\n            ...cloneBox(lastShape.box),\n            y: lastShape.box.y + offsetY,\n            x: lastShape.box.x + offsetX,\n          };\n\n          lastShape.points[0] = {\n            y: lastShape.points[0].y + offsetY,\n            x: lastShape.points[0].x + offsetX,\n          };\n        }\n        this.board.drawAll(root.shapes);\n      });\n    });\n  }\n\n  mouseup() {\n    this.flushTask();\n  }\n\n  flushTask() {\n    scheduler.flushTask();\n  }\n\n  /**\n   * Check if there is a selected shape.\n   */\n  isEmptySelectedShape() {\n    return !this.selectedShape;\n  }\n\n  /**\n   * findTarget find the shape in the document.\n   */\n  findTarget(point: Point): Shape | undefined {\n    let target;\n    this.update((root: Root) => {\n      for (const shape of root.shapes) {\n        if (shape.type === 'rect' && isInnerBox(shape.box, point)) {\n          target = shape;\n          return;\n        }\n      }\n    });\n    return target;\n  }\n}\n\nexport default SelectorWorker;\n","import Board from 'components/Editor/DrawingBoard/Canvas/Board';\nimport { ToolType } from 'features/boardSlices';\nimport Worker from './Worker';\n\nclass NoneWorker extends Worker {\n  type = ToolType.None;\n\n  update: Function;\n\n  board: Board;\n\n  constructor(update: Function, board: Board) {\n    super();\n    this.update = update;\n    this.board = board;\n  }\n\n  mousedown() {}\n\n  mousemove() {}\n\n  mouseup() {}\n\n  flushTask() {}\n}\n\nexport default NoneWorker;\n","import React, { useEffect, useRef } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { AppState } from 'app/rootReducer';\nimport { ToolType, setTool } from 'features/boardSlices';\nimport { Presence } from 'features/peerSlices';\nimport { BoardPresence } from './Canvas/Worker';\nimport Board from './Canvas/Board';\n\nexport default function DrawingBoard({ width, height }: { width: number; height: number }) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const boardRef = useRef<Board | null>(null);\n  const dispatch = useDispatch();\n  const client = useSelector((state: AppState) => state.docState.client);\n  const doc = useSelector((state: AppState) => state.docState.doc);\n  const tool = useSelector((state: AppState) => state.boardState.toolType);\n  const color = useSelector((state: AppState) => state.boardState.color);\n\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return () => {};\n    }\n    const board = new Board(canvasRef.current, doc!.update.bind(doc));\n    boardRef.current = board;\n\n    return () => {\n      board.destroy();\n    };\n  }, [doc]);\n\n  useEffect(() => {\n    if (!doc) {\n      return () => {};\n    }\n\n    const unsubscribe = doc.subscribe((event) => {\n      if (event.type === 'remote-change') {\n        boardRef.current?.drawAll(doc.getRoot().shapes);\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [doc]);\n\n  useEffect(() => {\n    if (!client || !doc) {\n      return () => {};\n    }\n\n    const unsubscribe = client.subscribe((event) => {\n      if (event.type === 'peers-changed') {\n        const documentKey = doc.getKey();\n        const changedPeers = event.value[documentKey];\n\n        for (const peerKey of Object.keys(changedPeers)) {\n          boardRef.current?.updatePresence(peerKey, changedPeers[peerKey]);\n        }\n      }\n    });\n\n    const clientId = client.getID()!;\n    const handleUpdateMeta = (data: BoardPresence) => {\n      const board = JSON.stringify(data || '');\n      boardRef.current?.updatePresence(clientId, {\n        board,\n      } as Presence);\n      client?.updatePresence('board', board);\n    };\n\n    boardRef.current?.addEventListener('mousemove', handleUpdateMeta);\n    boardRef.current?.addEventListener('mousedown', handleUpdateMeta);\n    boardRef.current?.addEventListener('mouseout', handleUpdateMeta);\n    boardRef.current?.addEventListener('mouseup', handleUpdateMeta);\n\n    return () => {\n      unsubscribe();\n      boardRef.current?.removeEventListener('mousemove', handleUpdateMeta);\n      boardRef.current?.removeEventListener('mousedown', handleUpdateMeta);\n      boardRef.current?.removeEventListener('mouseout', handleUpdateMeta);\n      boardRef.current?.removeEventListener('mouseup', handleUpdateMeta);\n    };\n  }, [client, doc]);\n\n  useEffect(() => {\n    const handleMouseup = () => {\n      if (tool === ToolType.Rect) {\n        dispatch(setTool(ToolType.Selector));\n      }\n    };\n\n    boardRef.current?.addEventListener('mouseup', handleMouseup);\n    return () => {\n      boardRef.current?.removeEventListener('mouseup', handleMouseup);\n    };\n  }, [doc, tool, dispatch]);\n\n  useEffect(() => {\n    if (!canvasRef.current) {\n      return;\n    }\n\n    boardRef.current?.setWidth(width);\n    boardRef.current?.setHeight(height);\n\n    if (doc?.getRoot().shapes) {\n      boardRef.current?.drawAll(doc!.getRoot().shapes);\n    }\n  }, [doc, width, height]);\n\n  useEffect(() => {\n    boardRef.current?.setTool(tool);\n  }, [doc, tool]);\n\n  useEffect(() => {\n    boardRef.current?.setColor(color);\n  }, [doc, color]);\n\n  useEffect(() => {\n    if (tool === ToolType.Clear) {\n      boardRef.current?.clearBoard();\n      dispatch(setTool(ToolType.None));\n    }\n  }, [doc, tool, dispatch]);\n\n  return <canvas ref={canvasRef} />;\n}\n","import React from 'react';\nimport SvgIcon, { SvgIconProps } from '@material-ui/core/SvgIcon';\n\nexport default function Eraser({ fontSize }: SvgIconProps) {\n  return (\n    <SvgIcon fontSize={fontSize}>\n      <svg version=\"1.1\" id=\"Layer_1\" x=\"0px\" y=\"0px\" viewBox=\"0 0 480.001 480.001\">\n        <g>\n          <g>\n            <path\n              d=\"M333.142,350.846c0.115-0.115,0.215-0.239,0.323-0.357l129.681-129.706c10.878-10.878,16.864-25.368,16.855-40.8\n          c-0.01-15.409-5.999-29.865-16.854-40.694l-97.844-97.874c-10.853-10.845-25.326-16.817-40.75-16.817\n          c-15.426,0-29.895,5.974-40.741,16.82L16.855,308.329C5.974,319.21-0.012,333.713,0,349.168\n          c0.013,15.425,6.002,29.884,16.854,40.7l62.592,62.606c0.061,0.061,0.127,0.112,0.188,0.171c0.174,0.165,0.349,0.331,0.534,0.483\n          c0.082,0.067,0.171,0.126,0.255,0.19c0.175,0.135,0.349,0.271,0.532,0.395c0.07,0.047,0.145,0.085,0.215,0.13\n          c0.205,0.131,0.412,0.26,0.627,0.376c0.051,0.026,0.103,0.048,0.154,0.074c0.239,0.123,0.482,0.241,0.732,0.346\n          c0.033,0.014,0.067,0.024,0.101,0.037c0.269,0.108,0.54,0.208,0.819,0.293c0.034,0.011,0.07,0.017,0.104,0.027\n          c0.276,0.081,0.556,0.154,0.841,0.211c0.082,0.017,0.165,0.023,0.247,0.038c0.239,0.041,0.479,0.084,0.724,0.107\n          c0.33,0.033,0.663,0.051,0.998,0.051h137.91h159.308c5.522,0,10-4.478,10-10c0-5.522-4.478-10-10-10H248.566l84.22-84.236\n          C332.904,351.06,333.027,350.96,333.142,350.846z M220.285,435.404H90.66l-59.675-59.689\n          c-7.076-7.054-10.977-16.487-10.985-26.563c-0.008-10.106,3.897-19.582,10.996-26.681l129.825-129.803l151.091,151.091\n          L220.285,435.404z M174.965,178.527L297.953,55.56c7.069-7.069,16.516-10.963,26.6-10.963c10.085,0,19.536,3.895,26.609,10.962\n          l97.85,97.88c7.08,7.063,10.982,16.493,10.989,26.557c0.006,10.085-3.899,19.547-10.998,26.645l-122.95,122.974L174.965,178.527z\"\n            />\n          </g>\n        </g>\n      </svg>\n    </SvgIcon>\n  );\n}\n","import React from 'react';\nimport SvgIcon, { SvgIconProps } from '@material-ui/core/SvgIcon';\n\nexport default function Mouse({ fontSize }: SvgIconProps) {\n  return (\n    <SvgIcon fontSize={fontSize}>\n      <svg viewBox=\"-36 0 392 392.40392\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"m43 355.03125c.492188 3.949219 3.273438 7.230469 7.085938 8.355469 3.816406 1.128906 7.933593-.109375 10.492187-3.152344l68.5-81.507813 72.972656 109.230469c3.058594 4.585938 9.25 5.828125 13.84375 2.777344l65.226563-43.285156c4.589844-3.046875 5.851562-9.234375 2.820312-13.835938l-72.304687-109.675781 101.714843-31.453125c3.800782-1.175781 6.542969-4.488281 6.984376-8.441406.441406-3.953125-1.5-7.792969-4.945313-9.777344l-300.195313-172.929687c-3.289062-1.894532-7.363281-1.765626-10.523437.332031-3.160156 2.097656-4.863281 5.804687-4.394531 9.566406zm242.539062-174.878906-92.539062 28.617187c-3.003906.929688-5.398438 3.21875-6.460938 6.179688-1.058593 2.960937-.664062 6.25 1.066407 8.875l74.152343 112.476562-48.613281 32.261719-74.832031-112.023438c-1.746094-2.617187-4.625-4.257812-7.765625-4.429687-.183594-.011719-.367187-.015625-.550781-.015625-2.953125 0-5.753906 1.308594-7.652344 3.566406l-62.320312 74.152344-37.421876-301.128906zm0 0\" />\n      </svg>\n    </SvgIcon>\n  );\n}\n","import React from 'react';\nimport SvgIcon, { SvgIconProps } from '@material-ui/core/SvgIcon';\n\nexport default function Rect({ fontSize }: SvgIconProps) {\n  return (\n    <SvgIcon fontSize={fontSize}>\n      <svg enableBackground=\"new 0 0 506.1 506.1\" viewBox=\"0 0 506.1 506.1\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"m489.609 506.1h-473.118c-9.108 0-16.491-7.384-16.491-16.491v-473.118c0-9.108 7.383-16.491 16.491-16.491h473.119c9.107 0 16.49 7.383 16.49 16.491v473.118c0 9.107-7.383 16.491-16.491 16.491zm-456.628-32.982h440.138v-440.137h-440.138z\" />\n      </svg>\n    </SvgIcon>\n  );\n}\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useCallback, useEffect, ChangeEvent } from 'react';\nimport { ActionCreatorWithPayload } from '@reduxjs/toolkit';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Box from '@material-ui/core/Box';\nimport Switch from '@material-ui/core/Switch';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Typography from '@material-ui/core/Typography';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\n\nimport { Preview, setPreview } from 'features/docSlices';\nimport {\n  Theme,\n  CodeKeyMap,\n  TabSize,\n  setDarkMode,\n  setCodeKeyMap,\n  setTabSize,\n  setUserName,\n  setUserColor,\n} from 'features/settingSlices';\nimport { AppState } from 'app/rootReducer';\nimport { debounce } from '@material-ui/core';\nimport { updatePresenceColor } from 'features/peerSlices';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      minWidth: '320px',\n      borderRadius: '4px',\n    },\n    header: {\n      borderBottom: `1px solid ${theme.palette.text.disabled}`,\n    },\n    title: {\n      padding: '12px 16px',\n    },\n    list: {\n      padding: '8px 18px 18px 18px',\n      lineHeight: '19px',\n    },\n    item: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      fontSize: '15px',\n      marginTop: '12px',\n      pointerEvents: 'none',\n    },\n    itemTitle: {\n      whiteSpace: 'nowrap',\n      display: 'flex',\n      alignItems: 'center',\n    },\n    itemInfo: {\n      minWidth: 140,\n      paddingLeft: '12px',\n      borderRadius: '4px',\n      textAlign: 'left',\n      pointerEvents: 'auto',\n    },\n  }),\n);\n\nexport default function Settings() {\n  const dispatch = useDispatch();\n  const classes = useStyles();\n\n  const client = useSelector((state: AppState) => state.docState.client);\n  const doc = useSelector((state: AppState) => state.docState.doc);\n  const preview = useSelector((state: AppState) => state.docState.preview);\n  const menu = useSelector((state: AppState) => state.settingState.menu);\n\n  const debounceSave = useCallback(\n    debounce((value) => {\n      dispatch(setUserName(value));\n    }, 2000),\n    [],\n  );\n\n  useEffect(() => {\n    if (!doc) {\n      return () => {};\n    }\n\n    const unsubscribe = doc.subscribe((event) => {\n      if (event.type === 'remote-change') {\n        dispatch(setPreview(doc.getRoot().preview || Preview.HTML));\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [doc]);\n\n  const handleInputUserName = useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      const { value } = event.target;\n      debounceSave(value);\n    },\n    [debounceSave],\n  );\n\n  const handleInputUserColor = useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      const { value } = event.target;\n      if (client) {\n        dispatch(updatePresenceColor(value));\n      }\n\n      dispatch(setUserColor(value));\n    },\n    [dispatch],\n  );\n\n  const handlePreviewChange = useCallback(\n    (event: ChangeEvent<{ name?: string; value: unknown }>) => {\n      if (!doc) {\n        return;\n      }\n      const value = event.target.value as Preview;\n      doc.update((root) => {\n        // eslint-disable-next-line no-param-reassign\n        root.preview = value;\n      });\n\n      dispatch(setPreview(value));\n    },\n    [doc, dispatch],\n  );\n\n  function handleChange<T>(action: ActionCreatorWithPayload<T>) {\n    return (event: ChangeEvent<{ name?: string; value: unknown }>) => {\n      dispatch(action(event.target.value as T));\n    };\n  }\n\n  const handleThemeChanged = useCallback(\n    (input, checked) => {\n      dispatch(setDarkMode(checked));\n    },\n    [dispatch, setDarkMode],\n  );\n\n  return (\n    <div className={classes.root}>\n      <Box>\n        <header className={classes.header}>\n          <Typography className={classes.title} variant=\"h6\">\n            Settings\n          </Typography>\n        </header>\n      </Box>\n      <div className={classes.list}>\n        <div className={classes.item}>\n          <div className={classes.itemTitle}>Name</div>\n          <FormControl className={classes.itemInfo}>\n            <TextField\n              id=\"standard-basic\"\n              variant=\"standard\"\n              defaultValue={menu.userName}\n              onInput={handleInputUserName}\n            />\n          </FormControl>\n        </div>\n        <div className={classes.item}>\n          <div className={classes.itemTitle}>Color</div>\n          <FormControl className={classes.itemInfo}>\n            <input type=\"color\" defaultValue={menu.userColor} onChange={handleInputUserColor} />\n          </FormControl>\n        </div>\n        <div className={classes.item}>\n          <div className={classes.itemTitle}>Preview</div>\n          <FormControl className={classes.itemInfo}>\n            <Select name=\"preview\" value={preview} onChange={handlePreviewChange} displayEmpty>\n              {Object.entries(Preview).map(([display, value]: [string, string]) => {\n                return (\n                  <MenuItem value={value} key={value}>\n                    {display}\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </FormControl>\n        </div>\n        <div className={classes.item}>\n          <div className={classes.itemTitle}>Tab Size</div>\n          <FormControl className={classes.itemInfo}>\n            <Select value={menu.tabSize} onChange={handleChange(setTabSize)} displayEmpty>\n              {Object.entries(TabSize).map(([key, tabSize]: [string, string]) => {\n                return (\n                  <MenuItem value={tabSize} key={key}>\n                    {`${tabSize} spaces`}\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </FormControl>\n        </div>\n        <div className={classes.item}>\n          <div className={classes.itemTitle}>Key Binding</div>\n          <FormControl className={classes.itemInfo}>\n            <Select value={menu.codeKeyMap} onChange={handleChange(setCodeKeyMap)} displayEmpty>\n              {Object.entries(CodeKeyMap).map(([display, codeKeyMap]: [string, string]) => {\n                return (\n                  <MenuItem value={codeKeyMap} key={codeKeyMap}>\n                    {display}\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </FormControl>\n        </div>\n        <div className={classes.item}>\n          <div className={classes.itemTitle}>Dark Mode</div>\n          <FormControl className={classes.itemInfo}>\n            <Switch checked={menu.theme === Theme.Dark} onChange={handleThemeChanged} />\n          </FormControl>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useCallback, useState, MouseEvent } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport Badge from '@material-ui/core/Badge';\nimport Avatar from '@material-ui/core/Avatar';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Box from '@material-ui/core/Box';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\n\nimport Popover from 'components/commons/Popover';\nimport { AppState } from 'app/rootReducer';\nimport { ToolType, setTool, Color, setColor } from 'features/boardSlices';\nimport SvgIcon, { SvgIconProps } from '@material-ui/core/SvgIcon';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    button: {\n      marginLeft: 3,\n      marginRight: 3,\n      padding: 8,\n    },\n    select: {\n      marginLeft: 3,\n      marginRight: 3,\n      padding: 8,\n      color: theme.palette.primary.main,\n    },\n    box: {\n      width: '184px',\n      display: 'flex',\n      flexWrap: 'wrap',\n      '& > *': {\n        margin: theme.spacing(1),\n      },\n    },\n    colorIcon: {\n      '&:hover': {\n        cursor: 'pointer',\n      },\n      width: theme.spacing(3.1),\n      height: theme.spacing(3.1),\n    },\n    badge: {\n      backgroundColor: ({ color }: { color: Color }) => color,\n    },\n  }),\n);\n\ninterface ButtonWithColorProps extends SvgIconProps {\n  tooltip: string;\n  toolType: ToolType;\n  Icon: typeof SvgIcon;\n}\n\nexport default function ButtonWithColor({ toolType, Icon, tooltip, fontSize }: ButtonWithColorProps) {\n  const dispatch = useDispatch();\n  const currentToolType = useSelector((state: AppState) => state.boardState.toolType);\n  const color = useSelector((state: AppState) => state.boardState.color);\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | undefined>();\n  const classes = useStyles({ color });\n\n  const handleOpen = useCallback(\n    (event: MouseEvent<HTMLButtonElement>) => {\n      setAnchorEl(event.currentTarget);\n    },\n    [currentToolType],\n  );\n\n  const handleClose = useCallback(() => {\n    setAnchorEl(undefined);\n  }, []);\n\n  const handleSelectTool = useCallback(\n    (event: MouseEvent<HTMLButtonElement>) => {\n      if (currentToolType === toolType) {\n        handleOpen(event);\n        return;\n      }\n\n      dispatch(setTool(toolType));\n    },\n    [currentToolType, color],\n  );\n\n  const handleSelectColor = (nextColor: Color) => () => {\n    dispatch(setTool(toolType));\n    dispatch(setColor(nextColor));\n    handleClose();\n  };\n\n  return (\n    <>\n      <Tooltip title={tooltip} arrow className={currentToolType === toolType ? classes.select : classes.button}>\n        <IconButton aria-label={tooltip} onClick={handleSelectTool}>\n          {currentToolType === toolType ? (\n            <Badge\n              variant=\"dot\"\n              classes={{ badge: classes.badge }}\n              anchorOrigin={{\n                vertical: 'bottom',\n                horizontal: 'right',\n              }}\n            >\n              <Icon fontSize={fontSize} />\n            </Badge>\n          ) : (\n            <Icon fontSize={fontSize} />\n          )}\n        </IconButton>\n      </Tooltip>\n\n      <Popover\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n      >\n        <Box p={2} className={classes.box}>\n          {Object.entries(Color).map(([name, _color]: [string, Color]) => {\n            const selected = color === _color && currentToolType === toolType;\n            return (\n              <Tooltip key={name} title={name} arrow>\n                <Box border={3} borderRadius=\"50%\" borderColor={selected ? 'primary.main' : ''}>\n                  <Avatar\n                    className={classes.colorIcon}\n                    style={{ backgroundColor: _color }}\n                    onClick={handleSelectColor(_color)}\n                  >\n                    {/* If there are no spaces, the default svg is output. */}{' '}\n                  </Avatar>\n                </Box>\n              </Tooltip>\n            );\n          })}\n        </Box>\n      </Popover>\n    </>\n  );\n}\n","import React, { useState, useCallback, MouseEvent } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Divider from '@material-ui/core/Divider';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport TextFieldsIcon from '@material-ui/icons/TextFields';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport BrushIcon from '@material-ui/icons/Brush';\nimport DeleteOutlineIcon from '@material-ui/icons/DeleteOutline';\nimport GitHubIcon from '@material-ui/icons/GitHub';\n\nimport EraserIcon from 'assets/icons/Eraser';\nimport MouseIcon from 'assets/icons/Mouse';\nimport RectIcon from 'assets/icons/Rect';\nimport Popover from 'components/commons/Popover';\nimport Settings from 'components/Editor/Sidebar/Settings';\nimport ButtonWithColor from 'components/Editor/Sidebar/ButtonWithColor';\nimport { AppState } from 'app/rootReducer';\nimport { ToolType, setTool } from 'features/boardSlices';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      marginTop: 60,\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    divider: {\n      marginTop: 5,\n      marginBottom: 5,\n    },\n    button: {\n      marginLeft: 3,\n      marginRight: 3,\n      padding: 8,\n    },\n    select: {\n      marginLeft: 3,\n      marginRight: 3,\n      padding: 8,\n      color: theme.palette.primary.main,\n    },\n  }),\n);\n\nexport default function Sidebar() {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const tool = useSelector((state: AppState) => state.boardState.toolType);\n  const [anchorEl, setAnchorEl] = useState<HTMLButtonElement | undefined>();\n\n  const handleSelectTool = (nextTool: ToolType) => () => {\n    dispatch(setTool(nextTool));\n  };\n\n  const handleSettingsClick = useCallback(\n    (event: MouseEvent<HTMLButtonElement>) => {\n      dispatch(setTool(ToolType.Settings));\n      setAnchorEl(event.currentTarget);\n    },\n    [dispatch],\n  );\n\n  const handleSettingsClose = useCallback(() => {\n    setAnchorEl(undefined);\n    dispatch(setTool(ToolType.None));\n  }, [dispatch]);\n\n  return (\n    <div className={classes.root}>\n      <Tooltip title=\"Code\" arrow className={tool === ToolType.None ? classes.select : classes.button}>\n        <IconButton aria-label=\"Code\" onClick={handleSelectTool(ToolType.None)}>\n          <TextFieldsIcon fontSize=\"small\" />\n        </IconButton>\n      </Tooltip>\n      <ButtonWithColor toolType={ToolType.Line} Icon={BrushIcon} fontSize=\"small\" tooltip=\"Brush\" />\n      <ButtonWithColor toolType={ToolType.Rect} Icon={RectIcon} fontSize=\"small\" tooltip=\"Shape\" />\n      <Tooltip title=\"Selector\" arrow className={tool === ToolType.Selector ? classes.select : classes.button}>\n        <IconButton aria-label=\"selector\" onClick={handleSelectTool(ToolType.Selector)}>\n          <MouseIcon fontSize=\"small\" />\n        </IconButton>\n      </Tooltip>\n      <Tooltip title=\"Eraser\" arrow className={tool === ToolType.Eraser ? classes.select : classes.button}>\n        <IconButton aria-label=\"eraser\" onClick={handleSelectTool(ToolType.Eraser)}>\n          <EraserIcon fontSize=\"small\" />\n        </IconButton>\n      </Tooltip>\n      <Tooltip title=\"Clear\" arrow className={classes.button}>\n        <IconButton aria-label=\"selector\" onClick={handleSelectTool(ToolType.Clear)}>\n          <DeleteOutlineIcon fontSize=\"default\" />\n        </IconButton>\n      </Tooltip>\n      <Divider className={classes.divider} />\n      <Tooltip title=\"Settings\" arrow>\n        <IconButton aria-label=\"settings\" onClick={handleSettingsClick}>\n          <SettingsIcon fontSize=\"small\" />\n        </IconButton>\n      </Tooltip>\n      <Tooltip title=\"GitHub\" arrow className={classes.button}>\n        <IconButton aria-label=\"selector\" href=\"https://github.com/yorkie-team/codepair\">\n          <GitHubIcon fontSize=\"default\" />\n        </IconButton>\n      </Tooltip>\n      <Popover anchorEl={anchorEl} onClose={handleSettingsClose}>\n        <Settings />\n      </Popover>\n    </div>\n  );\n}\n","import React, { useEffect, useState, useRef, useCallback } from 'react';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\n\nimport CodeEditor from 'components/Editor/CodeEditor';\nimport DrawingBoard from 'components/Editor/DrawingBoard';\nimport Sidebar from 'components/Editor/Sidebar';\nimport { ToolType } from 'features/boardSlices';\n\nexport const NAVBAR_HEIGHT = 64;\nconst SIDEBAR_WIDTH = 46;\n\ninterface EditorProps {\n  tool: ToolType;\n}\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n      display: 'flex',\n    },\n    editor: {\n      width: `calc(100% - ${SIDEBAR_WIDTH}px)`,\n      flex: '0 0 auto',\n    },\n    codeEditor: {\n      width: '100%',\n      height: `calc(100vh - ${NAVBAR_HEIGHT}px)`,\n    },\n    canvas: {\n      top: NAVBAR_HEIGHT,\n      height: `calc(100vh - ${NAVBAR_HEIGHT}px)`,\n      width: `calc(100% - ${SIDEBAR_WIDTH}px)`,\n      position: 'fixed',\n      /**\n       * pointer-events\n       *   - 'auto': Show code mirror first\n       *   - 'none': Show canvas first\n       */\n      pointerEvents: (tool: ToolType) => (tool === ToolType.None ? 'none' : 'auto'),\n    },\n  }),\n);\n\nexport default function Editor({ tool }: EditorProps) {\n  const classes = useStyles(tool);\n\n  const [width, setWidth] = useState(0);\n  const [height, setHeight] = useState(0);\n\n  const divRef = useRef<HTMLDivElement>(null);\n  const codeEditorRef = useRef<CodeMirror.Editor>(null);\n\n  const handleClickEditor = useCallback(() => {\n    if (tool === ToolType.None) {\n      codeEditorRef.current?.focus();\n    }\n  }, [tool]);\n\n  useEffect(() => {\n    const onResize = () => {\n      if (!divRef.current) {\n        return;\n      }\n\n      const rect = divRef.current?.getBoundingClientRect();\n      setWidth(rect.width);\n      setHeight(rect.height);\n    };\n\n    onResize();\n    window.addEventListener('resize', onResize);\n\n    return () => {\n      window.removeEventListener('resize', onResize);\n    };\n  }, []);\n\n  return (\n    <div className={classes.root} onClick={handleClickEditor} aria-hidden=\"true\">\n      <div className={classes.editor} ref={divRef}>\n        <div className={classes.codeEditor}>\n          <CodeEditor forwardedRef={codeEditorRef} />\n        </div>\n        <div className={classes.canvas}>\n          <DrawingBoard width={width} height={height} />\n        </div>\n      </div>\n      <Sidebar />\n    </div>\n  );\n}\n","/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { Box } from '@material-ui/core';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Alert from '@material-ui/lab/Alert';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport { AppState } from 'app/rootReducer';\nimport {\n  activateClient,\n  deactivateClient,\n  createDocument,\n  detachDocument,\n  attachDoc,\n  attachDocLoading,\n  CodeMode,\n  setCodeMode,\n  Preview,\n  setPreview,\n  DocStatus,\n  setStatus,\n} from 'features/docSlices';\nimport { syncPeer } from 'features/peerSlices';\nimport Editor, { NAVBAR_HEIGHT } from './Editor';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    loading: {\n      display: 'flex',\n      height: `calc(100vh - ${NAVBAR_HEIGHT}px)`,\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n  }),\n);\n\n// eslint-disable-next-line func-names\nexport default function (props: { docKey: string }) {\n  const { docKey } = props;\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const client = useSelector((state: AppState) => state.docState.client);\n  const doc = useSelector((state: AppState) => state.docState.doc);\n  const status = useSelector((state: AppState) => state.docState.status);\n  const tool = useSelector((state: AppState) => state.boardState.toolType);\n  const loading = useSelector((state: AppState) => state.docState.loading);\n  const errorMessage = useSelector((state: AppState) => state.docState.errorMessage);\n\n  useEffect(() => {\n    dispatch(activateClient());\n    return () => {\n      dispatch(deactivateClient());\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!client || !doc) {\n      return () => {};\n    }\n\n    const unsubscribe = client.subscribe((event) => {\n      if (event.type === 'peers-changed') {\n        const documentKey = doc.getKey();\n        const changedPeers = event.value[documentKey];\n        dispatch(\n          syncPeer({\n            myClientID: client.getID()!,\n            changedPeers,\n          }),\n        );\n      }\n\n      if (\n        status === DocStatus.Connect &&\n        ((event.type === 'status-changed' && event.value === 'deactivated') ||\n          (event.type === 'stream-connection-status-changed' && event.value === 'disconnected') ||\n          (event.type === 'document-synced' && event.value === 'sync-failed'))\n      ) {\n        dispatch(setStatus(DocStatus.Disconnect));\n      } else if (\n        status === DocStatus.Disconnect &&\n        (event.type === 'peers-changed' ||\n          event.type === 'documents-changed' ||\n          (event.type === 'status-changed' && event.value === 'activated') ||\n          (event.type === 'stream-connection-status-changed' && event.value === 'connected') ||\n          (event.type === 'document-synced' && event.value === 'synced'))\n      ) {\n        dispatch(setStatus(DocStatus.Connect));\n      }\n    });\n\n    return () => {\n      unsubscribe();\n    };\n  }, [client, doc, status]);\n\n  useEffect(() => {\n    dispatch(createDocument(docKey));\n    return () => {\n      dispatch(detachDocument());\n    };\n  }, [docKey]);\n\n  useEffect(() => {\n    async function attachDocAsync() {\n      if (!client || !doc) {\n        return;\n      }\n\n      dispatch(attachDocLoading(true));\n      await dispatch(attachDoc({ client, doc }));\n      dispatch(setCodeMode(doc.getRoot().mode || CodeMode.Markdown));\n      dispatch(setPreview(doc.getRoot().preview || Preview.HTML));\n      dispatch(attachDocLoading(false));\n    }\n\n    attachDocAsync();\n    return () => {\n      dispatch(attachDocLoading(true));\n    };\n  }, [client, doc]);\n\n  if (errorMessage) {\n    return (\n      <div>\n        <Snackbar open anchorOrigin={{ vertical: 'top', horizontal: 'center' }}>\n          <Alert severity=\"warning\">{errorMessage || 'fail to attach document'}</Alert>\n        </Snackbar>\n      </div>\n    );\n  }\n\n  if (loading || !client || !doc) {\n    return (\n      <Box className={classes.loading}>\n        <CircularProgress color=\"inherit\" />\n      </Box>\n    );\n  }\n\n  return <Editor tool={tool} />;\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit';\n\nexport interface MessageState {\n  type: 'success' | 'info' | 'warning' | 'error';\n  message: string;\n  open?: boolean;\n}\n\nconst initialMessageState: MessageState = {\n  type: 'error',\n  message: '',\n  open: false,\n};\n\nconst messageSlice = createSlice({\n  name: 'message',\n  initialState: initialMessageState,\n\n  reducers: {\n    showMessage(state, action: PayloadAction<MessageState>) {\n      const { payload } = action;\n\n      state.type = payload.type || 'error';\n      state.message = payload.message;\n      state.open = true;\n    },\n    hideMessage(state) {\n      state.open = false;\n    },\n  },\n});\n\nexport const { showMessage, hideMessage } = messageSlice.actions;\nexport default messageSlice.reducer;\n","import React, { ChangeEvent, Fragment, ReactNode, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport {\n  Box,\n  Button,\n  Collapse,\n  createStyles,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Divider,\n  Drawer,\n  IconButton,\n  Input,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  ListSubheader,\n  makeStyles,\n  Menu,\n  MenuItem,\n  Snackbar,\n  Tab,\n  Tooltip,\n  Typography,\n} from '@material-ui/core';\nimport {\n  ExpandMore,\n  ChevronRight,\n  MoreHoriz,\n  Add,\n  Delete,\n  InsertDriveFile,\n  CreateNewFolder,\n  Edit,\n  OpenInBrowser,\n  FileCopy,\n  Update,\n  SubdirectoryArrowLeft,\n  Star,\n  AccountTree,\n  FolderOpen,\n  EventNote,\n  ListAlt,\n} from '@material-ui/icons';\nimport { useHistory, useParams } from 'react-router';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { AppState } from 'app/rootReducer';\nimport {\n  copyMarkdownTextForGroup,\n  favoriteSelector,\n  GroupType,\n  ItemType,\n  LinkItemType,\n  newChildGroupAt,\n  newGroup,\n  newGroupAt,\n  newLink,\n  newLinkByCurrentPage,\n  removeGroup,\n  removeLink,\n  setLinkFileLink,\n  setLinkName,\n  setLinkOpens,\n  toggleFavorite,\n  toggleLinkOpen,\n} from 'features/linkSlices';\nimport { TabContext, TabList, TabPanel } from '@material-ui/lab';\nimport { Theme } from 'features/settingSlices';\nimport { showMessage } from 'features/messageSlices';\nimport { NavTabType, toggleLinkTab } from 'features/navSlices';\n\ninterface SideBarProps {\n  open: boolean;\n}\n\nconst SIDEBAR_WIDTH = 300;\n\nfunction traverse(parent: any, data: any[], callback: (item: any, parent: any) => void) {\n  data.forEach((item) => {\n    callback(item, parent);\n    traverse(item, item.links || [], callback);\n  });\n}\n\nfunction findOne(data: any[], callback: (item: any) => boolean) {\n  let result: any = null;\n  traverse(null, data, (item) => {\n    if (callback(item)) {\n      result = item;\n    }\n  });\n  return result;\n}\n\nfunction getTitle() {\n  let { title } = document;\n\n  const cm = document.querySelector('.CodeMirror');\n\n  if (cm) {\n    const { CodeMirror } = cm as any;\n    const doc = CodeMirror.getDoc();\n    const count = doc.lineCount();\n    const headings = [];\n\n    for (let i = 0; i < count; i += 1) {\n      const line = doc.getLine(i).trim();\n      const match = line.match(/^(#+)\\s+(.*)/);\n      if (match) {\n        const level = match[1].length;\n        const text = match[2];\n        headings.push({ level, text, originalText: line });\n        break;\n      }\n    }\n\n    if (headings.length > 0) {\n      const { text } = headings[0];\n      if (text) {\n        title = text;\n      }\n    }\n  }\n\n  return title;\n}\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    title: {\n      flexGrow: 1,\n      padding: '15px 16px',\n      backgroundColor: '#f5f5f5',\n    },\n    tabListDark: {\n      backgroundColor: '#303030',\n    },\n    tabListLight: {\n      backgroundColor: '#fafafa',\n      borderBottom: '1px solid #e8e8e8',\n    },\n    drawer: {\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      right: 0,\n      bottom: 0,\n      flexShrink: 0,\n      transform: (props: SideBarProps) => `translateX(${props.open ? 0 : -SIDEBAR_WIDTH}px) translateZ(0)`,\n      [`& .MuiDrawer-paper`]: {\n        width: SIDEBAR_WIDTH,\n        boxSizing: 'border-box',\n        position: 'absolute',\n        transition: 'width 225ms cubic-bezier(0, 0, 0.2, 1) 0ms',\n      },\n\n      [`& .MuiListItem-root`]: {\n        paddingTop: 2,\n        paddingBottom: 2,\n      },\n\n      [`& .MuiTabPanel-root`]: {\n        padding: 0,\n      },\n\n      [`& .MuiTab-root`]: {\n        minWidth: 0,\n        padding: '0 16px',\n        fontSize: '0.875rem',\n        textTransform: 'none',\n      },\n    },\n    listItemText: {\n      [`& .MuiTypography-root`]: {\n        fontSize: '0.875rem',\n        paddingLeft: 8,\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n      },\n    },\n    listSubHeader: {\n      'line-height': 1.5,\n      [`&:hover .group-item-button`]: {\n        visibility: 'visible !important',\n      },\n    },\n    listItem: {\n      '&:hover': {\n        backgroundColor: 'rgba(0, 0, 0, 0.04)',\n      },\n    },\n    sidebarItem: {\n      [`&:hover .sidebar-item-more`]: {\n        visibility: 'visible !important',\n      },\n    },\n    level0: {\n      paddingLeft: theme.spacing(1),\n    },\n    level1: {\n      paddingLeft: theme.spacing(3),\n    },\n    level2: {\n      paddingLeft: theme.spacing(5),\n    },\n    level3: {\n      paddingLeft: theme.spacing(7),\n    },\n    level4: {\n      paddingLeft: theme.spacing(9),\n    },\n    level5: {\n      paddingLeft: theme.spacing(10),\n    },\n    level6: {\n      paddingLeft: theme.spacing(12),\n    },\n    level7: {\n      paddingLeft: theme.spacing(14),\n    },\n    level8: {\n      paddingLeft: theme.spacing(16),\n    },\n    level9: {\n      paddingLeft: theme.spacing(18),\n    },\n    level10: {\n      paddingLeft: theme.spacing(20),\n    },\n    moreMenu: {},\n  }),\n);\n\ninterface OpenState {\n  [key: string]: boolean;\n}\n\nfunction MoreIcon({ open, onClick }: { open: boolean; onClick: () => void }) {\n  return open ? (\n    <ExpandMore\n      fontSize=\"small\"\n      onClick={(e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        onClick();\n      }}\n    />\n  ) : (\n    <ChevronRight\n      fontSize=\"small\"\n      onClick={(e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        onClick();\n      }}\n    />\n  );\n}\n\nconst options = [\n  'Favorite',\n  '-',\n  'Add link',\n  'Add current note',\n  'Rename',\n  'Delete',\n  'Update link',\n  '-',\n  'Open in Browser',\n  'Copy',\n];\nconst headingOptions = ['Favorite', '-', 'Open in Browser', 'Copy'];\nconst groupOptions = [\n  'Favorite',\n  '-',\n  'Add current note',\n  'Add child group',\n  'Add next group',\n  'Rename',\n  '-',\n  'Delete',\n  '-',\n  'Copy',\n];\n\ninterface MoreMenuProps {\n  item: LinkItemType;\n  startRename: () => void;\n}\nfunction MoreMenu({ item, startRename }: MoreMenuProps) {\n  const dispatch = useDispatch();\n  const favorite = useSelector((state: AppState) => state.linkState.favorite);\n  const classes = useStyles({ open: true });\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n  const { docKey } = useParams<{ docKey: string }>();\n  const open = Boolean(anchorEl);\n\n  const [dialogOpen, setDialogOpen] = React.useState(false);\n\n  const handleClickDialogOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleDialogClose = () => {\n    setDialogOpen(false);\n  };\n\n  const [openSnackbar, setOpenSnackbar] = React.useState(false);\n\n  const handleClickOpenSnackbar = () => {\n    setOpenSnackbar(true);\n  };\n\n  const handleCloseSnackbar = () => {\n    setOpenSnackbar(false);\n  };\n\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleDeleteLink = useCallback(() => {\n    dispatch(removeLink({ id: item.id }));\n  }, [dispatch, item.id]);\n\n  const handleCreateLink = useCallback(\n    (name: string) => {\n      dispatch(newLink({ parentId: item.id, name }));\n    },\n    [item.id, dispatch],\n  );\n\n  const handleUpdateLink = useCallback(() => {\n    dispatch(setLinkFileLink({ id: item.id, name: getTitle(), fileLink: `/${docKey}` }));\n  }, [item.id, dispatch, docKey]);\n\n  const handleCreateCurrentPage = useCallback(() => {\n    dispatch(newLinkByCurrentPage({ parentId: item.id, name: getTitle(), fileLink: `/${docKey}` }));\n  }, [item.id, docKey, dispatch]);\n\n  const handleClose = (command: string) => {\n    if (command === 'Favorite') {\n      dispatch(toggleFavorite(item.id));\n    } else if (command === 'Open in Browser') {\n      if (item.fileLink) {\n        switch (item.linkType) {\n          case 'pairy':\n            window.open(item.fileLink, item.fileLink);\n            break;\n          default:\n            window.open(item.fileLink, '_blank');\n        }\n      }\n    } else if (command === 'Rename') {\n      startRename();\n    } else if (command === 'Copy') {\n      let link = item.fileLink || '';\n      if (item.linkType === 'pairy') {\n        link = `${window.location.origin}${item.fileLink}`;\n      }\n\n      window.navigator.clipboard.writeText(link).then(() => {\n        handleClickOpenSnackbar();\n      });\n    } else if (command === 'Delete') {\n      handleClickDialogOpen();\n    } else if (command === 'Add link') {\n      handleCreateLink('Untitled name');\n    } else if (command === 'Add current note') {\n      handleCreateCurrentPage();\n    } else if (command === 'Update link') {\n      handleUpdateLink();\n    }\n\n    setAnchorEl(null);\n  };\n\n  return (\n    <div>\n      <IconButton onClick={handleClick} size=\"small\">\n        <MoreHoriz />\n      </IconButton>\n      <Menu\n        id=\"long-menu\"\n        className={classes.moreMenu}\n        MenuListProps={{\n          'aria-labelledby': 'long-button',\n        }}\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleClose}\n        PaperProps={{\n          style: {\n            // maxHeight: ITEM_HEIGHT * 4.5,\n            // width: 200,\n          },\n        }}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n      >\n        {options.map((option) =>\n          option === '-' ? (\n            <Divider key={`${option}-${Date.now()}-${Math.random()}`} />\n          ) : (\n            <MenuItem\n              key={option}\n              onClick={() => handleClose(option)}\n              style={{\n                color: option === 'Delete' ? 'red' : undefined,\n              }}\n            >\n              <ListItemIcon\n                style={{\n                  minWidth: 30,\n                }}\n              >\n                {option === 'Delete' ? (\n                  <Delete\n                    style={{\n                      color: 'red',\n                    }}\n                  />\n                ) : undefined}\n                {option === 'Add link' ? <SubdirectoryArrowLeft /> : undefined}\n                {option === 'Add current note' ? <SubdirectoryArrowLeft /> : undefined}\n                {option === 'Rename' ? <Edit /> : undefined}\n                {option === 'Open in Browser' ? <OpenInBrowser /> : undefined}\n                {option === 'Copy' ? <FileCopy /> : undefined}\n                {option === 'Update link' ? <Update /> : undefined}\n                {option === 'Favorite' ? (\n                  <Star\n                    style={{\n                      color: favorite.includes(item.id) ? 'blue' : undefined,\n                    }}\n                  />\n                ) : undefined}\n              </ListItemIcon>\n              <ListItemText primary={option} />\n            </MenuItem>\n          ),\n        )}\n      </Menu>\n      <Dialog\n        open={dialogOpen}\n        onClose={handleDialogClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">Confirm</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            If you delete the link, it cannot be recovered.Are you sure you want to delete it anyway?\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleDialogClose}>Cancel</Button>\n          <Button onClick={handleDeleteLink} autoFocus variant=\"contained\" color=\"primary\">\n            OK\n          </Button>\n        </DialogActions>\n      </Dialog>\n      <Snackbar\n        open={openSnackbar}\n        autoHideDuration={1000}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        onClose={handleCloseSnackbar}\n        message=\"Copy\"\n      />\n    </div>\n  );\n}\n\ninterface HeadingMoreMenuProps {\n  item: LinkItemType;\n}\n\nfunction HeadingMoreMenu({ item }: HeadingMoreMenuProps) {\n  const dispatch = useDispatch();\n  const favorite = useSelector((state: AppState) => state.linkState.favorite);\n  const classes = useStyles({ open: true });\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n  const open = Boolean(anchorEl);\n\n  const [openSnackbar, setOpenSnackbar] = React.useState(false);\n\n  const handleClickOpenSnackbar = () => {\n    setOpenSnackbar(true);\n  };\n\n  const handleCloseSnackbar = () => {\n    setOpenSnackbar(false);\n  };\n\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = (command: string) => {\n    if (command === 'Favorite') {\n      dispatch(toggleFavorite(item));\n    } else if (command === 'Open in Browser') {\n      if (item.fileLink) {\n        window.open(item.fileLink, '_blank');\n      }\n    } else if (command === 'Copy') {\n      const link = `${window.location.origin}${item.fileLink}`;\n\n      window.navigator.clipboard.writeText(link).then(() => {\n        handleClickOpenSnackbar();\n      });\n    }\n\n    setAnchorEl(null);\n  };\n\n  return (\n    <div>\n      <IconButton onClick={handleClick} size=\"small\">\n        <MoreHoriz />\n      </IconButton>\n      <Menu\n        id=\"long-menu\"\n        className={classes.moreMenu}\n        MenuListProps={{\n          'aria-labelledby': 'long-button',\n        }}\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleClose}\n        PaperProps={{\n          style: {\n            // maxHeight: ITEM_HEIGHT * 4.5,\n            // width: 200,\n          },\n        }}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n      >\n        {headingOptions.map((option) =>\n          option === '-' ? (\n            <Divider key={`${option}-${Date.now()}-${Math.random()}`} />\n          ) : (\n            <MenuItem key={option} onClick={() => handleClose(option)}>\n              <ListItemIcon\n                style={{\n                  minWidth: 30,\n                }}\n              >\n                {option === 'Open in Browser' ? <OpenInBrowser /> : undefined}\n                {option === 'Copy' ? <FileCopy /> : undefined}\n                {option === 'Favorite' ? (\n                  <Star\n                    style={{\n                      color: favorite.includes(item.id) ? 'blue' : undefined,\n                    }}\n                  />\n                ) : undefined}\n              </ListItemIcon>\n              <ListItemText primary={option} />\n            </MenuItem>\n          ),\n        )}\n      </Menu>\n      <Snackbar\n        open={openSnackbar}\n        autoHideDuration={1000}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        onClose={handleCloseSnackbar}\n        message=\"Copy\"\n      />\n    </div>\n  );\n}\n\ninterface GroupMoreMenuProps {\n  group: GroupType;\n  startRename: () => void;\n}\n\nfunction GroupMoreMenu({ group, startRename }: GroupMoreMenuProps) {\n  const dispatch = useDispatch();\n  const groups = useSelector((state: AppState) => state.linkState.groups);\n  const favorite = useSelector((state: AppState) => state.linkState.favorite);\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n  const { docKey } = useParams<{ docKey: string }>();\n  const open = Boolean(anchorEl);\n\n  const [dialogOpen, setDialogOpen] = React.useState(false);\n\n  const handleClickDialogOpen = () => {\n    setDialogOpen(true);\n  };\n\n  const handleDialogClose = () => {\n    setDialogOpen(false);\n  };\n\n  const handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleCreateCurrentPage = useCallback(() => {\n    dispatch(newLinkByCurrentPage({ parentId: group.id, name: getTitle(), fileLink: `/${docKey}` }));\n  }, [group.id, docKey, dispatch]);\n\n  const handleClose = (command: string) => {\n    if (command === 'Rename') {\n      startRename();\n    } else if (command === 'Delete') {\n      if (groups.length === 1) {\n        dispatch(\n          showMessage({\n            type: 'warning',\n            message: 'You can not delete the last group',\n          }),\n        );\n        return;\n      }\n\n      handleClickDialogOpen();\n    } else if (command === 'Add current note') {\n      handleCreateCurrentPage();\n    } else if (command === 'Add next group') {\n      dispatch(newGroupAt({ id: group.id, name: 'New Group' }));\n    } else if (command === 'Add child group') {\n      dispatch(newChildGroupAt({ parentId: group.id, name: 'New Group' }));\n    } else if (command === 'Favorite') {\n      dispatch(toggleFavorite(group.id));\n    } else if (command === 'Copy') {\n      dispatch(copyMarkdownTextForGroup(group.id));\n    }\n\n    setAnchorEl(null);\n  };\n\n  return (\n    <div>\n      <IconButton onClick={handleClick} size=\"small\" disableRipple>\n        <MoreHoriz />\n      </IconButton>\n      <Menu\n        id=\"long-menu\"\n        MenuListProps={{\n          'aria-labelledby': 'long-button',\n        }}\n        anchorEl={anchorEl}\n        open={open}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n      >\n        {groupOptions.map((option) =>\n          option === '-' ? (\n            <Divider key={`${option}-${Date.now()}-${Math.random()}`} />\n          ) : (\n            <MenuItem\n              key={option}\n              onClick={() => handleClose(option)}\n              disableRipple\n              style={{\n                color: option === 'Delete' ? 'red' : undefined,\n              }}\n            >\n              <ListItemIcon>\n                {option === 'Delete' ? (\n                  <Delete\n                    style={{\n                      color: 'red',\n                    }}\n                  />\n                ) : undefined}\n                {option === 'Rename' ? <InsertDriveFile /> : undefined}\n                {option === 'Add current note' ? <SubdirectoryArrowLeft /> : undefined}\n                {option === 'Add next group' ? <CreateNewFolder /> : undefined}\n                {option === 'Add child group' ? <SubdirectoryArrowLeft /> : undefined}\n                {option === 'Favorite' ? (\n                  <Star\n                    style={{\n                      color: favorite.includes(group.id) ? 'blue' : undefined,\n                    }}\n                  />\n                ) : undefined}\n                {option === 'Copy' ? <FileCopy /> : undefined}\n              </ListItemIcon>\n              <ListItemText primary={option} />\n            </MenuItem>\n          ),\n        )}\n      </Menu>\n      {dialogOpen && (\n        <Dialog\n          open={dialogOpen}\n          onClose={handleDialogClose}\n          aria-labelledby=\"alert-dialog-title\"\n          aria-describedby=\"alert-dialog-description\"\n        >\n          <DialogTitle id=\"alert-dialog-title\">Confirm</DialogTitle>\n          <DialogContent>\n            <DialogContentText id=\"alert-dialog-description\">Are you sure to delete this group?</DialogContentText>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleDialogClose}>Cancel</Button>\n            <Button\n              onClick={() => {\n                if (groups.length < 2) {\n                  dispatch(\n                    showMessage({\n                      type: 'warning',\n                      message: 'You can not delete the last group',\n                    }),\n                  );\n                  return;\n                }\n\n                dispatch(removeGroup({ id: group.id }));\n                handleDialogClose();\n              }}\n              autoFocus\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              OK\n            </Button>\n          </DialogActions>\n        </Dialog>\n      )}\n    </div>\n  );\n}\n\ninterface GroupItemProps {\n  group: GroupType;\n  level: number;\n  loopType: LoopType;\n}\n\nfunction GroupItem({ group, level, loopType }: GroupItemProps) {\n  const dispatch = useDispatch();\n  const opens = useSelector((state: AppState) => state.linkState.opens);\n  const favorite = useSelector((state: AppState) => state.linkState.favorite);\n  const classes = useStyles({\n    open: true,\n  });\n  const [isRename, setIsRename] = useState(false);\n  const textRef = useRef<string>(group.name);\n\n  const className = useMemo(() => {\n    switch (level) {\n      case 0:\n        return classes.level0;\n      case 1:\n        return classes.level1;\n      case 2:\n        return classes.level2;\n      case 3:\n        return classes.level3;\n      case 4:\n        return classes.level4;\n      case 5:\n        return classes.level5;\n      case 6:\n        return classes.level6;\n      case 7:\n        return classes.level7;\n      case 8:\n        return classes.level8;\n      case 9:\n        return classes.level9;\n      case 10:\n        return classes.level10;\n      default:\n        return classes.level0;\n    }\n  }, [level, classes]);\n\n  const isView = useMemo(() => {\n    if (loopType !== 'favorite' && favorite.includes(group.id)) {\n      return false;\n    }\n\n    return true;\n  }, [loopType, favorite, group.id]);\n\n  return (\n    <ListSubheader\n      className={[className, classes.listSubHeader].join(' ')}\n      style={{\n        display: isView ? 'flex' : 'none',\n        // justifyContent: 'space-between',\n        alignItems: 'center',\n      }}\n      onDoubleClick={(e) => {\n        e.stopPropagation();\n        setIsRename(true);\n      }}\n    >\n      <IconButton\n        size=\"small\"\n        onClick={() => dispatch(toggleLinkOpen(group.id))}\n        style={{ flex: 'none' }}\n        disableRipple\n      >\n        {opens[group.id] ? <ExpandMore fontSize=\"small\" /> : <ChevronRight fontSize=\"small\" />}\n      </IconButton>\n\n      {isRename ? (\n        <Input\n          autoFocus\n          defaultValue={textRef.current}\n          onBlur={() => {\n            setIsRename(false);\n            dispatch(setLinkName({ id: group.id, name: textRef.current }));\n          }}\n          onChange={(e) => {\n            textRef.current = e.target.value;\n          }}\n          onKeyUp={(e) => {\n            if (e.key === 'Escape') {\n              setIsRename(false);\n            } else if (e.key === 'Enter') {\n              setIsRename(false);\n              dispatch(setLinkName({ id: group.id, name: textRef.current }));\n            }\n          }}\n        />\n      ) : (\n        <div\n          style={{\n            flex: 1,\n            whiteSpace: 'nowrap',\n            overflow: 'hidden',\n            textOverflow: 'ellipsis',\n            display: 'flex',\n            alignItems: 'center',\n          }}\n          title={group.name}\n        >\n          <FolderOpen\n            style={{\n              marginRight: 8,\n            }}\n          />\n          {group.name}\n        </div>\n      )}\n      <div\n        className=\"group-item-button\"\n        style={{\n          flex: 'none',\n          display: 'flex',\n          alignItems: 'center',\n          visibility: 'hidden',\n        }}\n      >\n        <Tooltip title=\"Add new Link\">\n          <IconButton\n            disableRipple\n            size=\"small\"\n            style={{\n              flex: 'none',\n            }}\n            onClick={() => {\n              dispatch(newLink({ parentId: group.id, name: 'New Link' }));\n            }}\n          >\n            <Add />\n          </IconButton>\n        </Tooltip>\n        {isRename ? undefined : (\n          <GroupMoreMenu\n            group={group}\n            startRename={() => {\n              setIsRename(true);\n            }}\n          />\n        )}\n      </div>\n    </ListSubheader>\n  );\n}\n\ntype LoopType = 'links' | 'favorite';\n\ninterface SidebarItemProps {\n  item: LinkItemType;\n  level: number;\n  loopType: LoopType;\n}\n\nfunction SidebarItem({ item, level, loopType }: SidebarItemProps) {\n  const dispatch = useDispatch();\n  const opens = useSelector((state: AppState) => state.linkState.opens);\n  const favorite = useSelector((state: AppState) => state.linkState.favorite);\n  const history = useHistory();\n  const textRef = useRef<string>(item.name);\n  const [isRename, setIsRename] = useState(false);\n  const { docKey } = useParams<{ docKey: string }>();\n  const classes = useStyles({ open: opens[item.id] });\n\n  const setOpenCallback = useCallback(() => {\n    dispatch(toggleLinkOpen(item.id));\n  }, [item.id, dispatch]);\n\n  const handleRename = useCallback(\n    (name: string) => {\n      dispatch(setLinkName({ id: item.id, name }));\n    },\n    [item.id, dispatch],\n  );\n\n  const isView = useMemo(() => {\n    if (loopType !== 'favorite' && favorite.includes(item.id)) {\n      return false;\n    }\n\n    return true;\n  }, [loopType, favorite, item.id]);\n\n  const className = useMemo(() => {\n    switch (level) {\n      case 0:\n        return classes.level0;\n      case 1:\n        return classes.level1;\n      case 2:\n        return classes.level2;\n      case 3:\n        return classes.level3;\n      case 4:\n        return classes.level4;\n      case 5:\n        return classes.level5;\n      case 6:\n        return classes.level6;\n      case 7:\n        return classes.level7;\n      case 8:\n        return classes.level8;\n      case 9:\n        return classes.level9;\n      case 10:\n        return classes.level10;\n      default:\n        return classes.level0;\n    }\n  }, [level, classes]);\n\n  return (\n    <ListItem\n      className={[className, classes.sidebarItem].join(' ')}\n      button\n      selected={`/${docKey}` === item.fileLink}\n      disableRipple\n      style={{\n        display: isView ? 'flex' : 'none',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n      }}\n    >\n      {item.links?.length ? (\n        <MoreIcon open={opens[item.id]} onClick={setOpenCallback} />\n      ) : (\n        <EventNote fontSize=\"small\" />\n      )}\n      {isRename ? (\n        <Input\n          autoFocus\n          defaultValue={textRef.current}\n          onBlur={() => {\n            setIsRename(false);\n            handleRename(textRef.current);\n          }}\n          onChange={(e) => {\n            textRef.current = e.target.value;\n          }}\n          onKeyUp={(e) => {\n            if (e.key === 'Escape') {\n              setIsRename(false);\n            } else if (e.key === 'Enter') {\n              setIsRename(false);\n              handleRename(textRef.current);\n            }\n          }}\n        />\n      ) : (\n        <ListItemText\n          primary={item.name}\n          className={classes.listItemText}\n          title={item.name}\n          onClick={(e) => {\n            // open link to new tab if meta key is pressed\n            if (e.metaKey) {\n              switch (item.linkType) {\n                case 'pairy':\n                  window.open(item.fileLink, item.fileLink);\n                  break;\n                default:\n                  window.open(item.fileLink, '_blank');\n              }\n              return;\n            }\n\n            if (item.fileLink) {\n              switch (item.linkType) {\n                case 'pairy':\n                  history.push(item.fileLink, { name: item.name });\n                  break;\n                case 'heading':\n                  window.location.href = item.fileLink;\n                  break;\n                default:\n                  window.open(item.fileLink, '_blank');\n              }\n            }\n          }}\n        />\n      )}\n      <div\n        className=\"sidebar-item-more\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flex: 'none',\n          visibility: 'hidden',\n        }}\n      >\n        {isRename || item.linkType === 'heading' ? undefined : (\n          <MoreMenu\n            item={item}\n            startRename={() => {\n              setIsRename(true);\n            }}\n          />\n        )}\n      </div>\n    </ListItem>\n  );\n}\n\ninterface HeadingIconProps {\n  item: LinkItemType;\n}\n\nfunction HeadingIcon({ item }: HeadingIconProps) {\n  return (\n    <span\n      style={{\n        color: '#999',\n        fontWeight: 'bold',\n        textShadow: '1px 1px 0px #222',\n      }}\n    >\n      H{(item.level || 0) + 1}\n    </span>\n  );\n}\n\nfunction HeadingItem({ item, level, loopType }: SidebarItemProps) {\n  const classes = useStyles({ open: true });\n  const favorite = useSelector((state: AppState) => state.linkState.favorite);\n\n  const className = useMemo(() => {\n    switch (level) {\n      case 0:\n        return classes.level0;\n      case 1:\n        return classes.level1;\n      case 2:\n        return classes.level2;\n      case 3:\n        return classes.level3;\n      case 4:\n        return classes.level4;\n      case 5:\n        return classes.level5;\n      case 6:\n        return classes.level6;\n      case 7:\n        return classes.level7;\n      case 8:\n        return classes.level8;\n      case 9:\n        return classes.level9;\n      case 10:\n        return classes.level10;\n      default:\n        return classes.level0;\n    }\n  }, [level, classes]);\n\n  const isView = useMemo(() => {\n    if (loopType !== 'favorite' && favorite.some((it) => (it as LinkItemType).fileLink === item.fileLink)) {\n      return false;\n    }\n\n    return true;\n  }, [loopType, favorite, item.fileLink]);\n\n  return (\n    <ListItem\n      className={[className, classes.sidebarItem].join(' ')}\n      button\n      selected={`${window.location.pathname}${window.location.hash}` === item.fileLink}\n      disableRipple\n      style={{\n        display: isView ? 'flex' : 'none',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n      }}\n    >\n      <HeadingIcon item={item} />\n\n      <ListItemText\n        primary={item.name}\n        className={classes.listItemText}\n        title={item.name}\n        onClick={(e) => {\n          // open link to new tab if meta key is pressed\n          if (e.metaKey) {\n            window.open(item.fileLink, '_blank');\n            return;\n          }\n\n          if (item.fileLink) {\n            // window.history.pushState({}, '', item.fileLink);\n            window.location.href = item.fileLink;\n          }\n        }}\n      />\n      <div\n        className=\"sidebar-item-more\"\n        style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          flex: 'none',\n          visibility: 'hidden',\n        }}\n      >\n        <HeadingMoreMenu item={item} />\n      </div>\n    </ListItem>\n  );\n}\n\ninterface SideBarItemListProps {\n  links: ItemType[];\n  level: number;\n  loopType: LoopType;\n}\n\nfunction SideBarItemList({ links, level, loopType }: SideBarItemListProps) {\n  const opens = useSelector((state: AppState) => state.linkState.opens);\n  return (\n    <List style={{ padding: 0 }}>\n      {[...links].map((it) => {\n        return (\n          <Fragment key={it.id}>\n            {it.type === 'group' ? (\n              <GroupItem key={it.id} group={it} level={level} loopType={loopType} />\n            ) : (\n              <SidebarItem key={it.id} item={it} level={level} loopType={loopType} />\n            )}\n\n            {it.links && (\n              <Collapse in={opens[it.id]} timeout=\"auto\" unmountOnExit>\n                <SideBarItemList links={[...it.links]} level={level + 1} loopType={loopType} />\n              </Collapse>\n            )}\n          </Fragment>\n        );\n      })}\n    </List>\n  );\n}\n\ninterface GroupViewProps {\n  group: GroupType;\n  loopType: LoopType;\n}\n\nfunction GroupView({ group, loopType }: GroupViewProps) {\n  const opens = useSelector((state: AppState) => state.linkState.opens);\n  return (\n    <Box>\n      <GroupItem group={group} level={0} loopType={loopType} />\n      <Collapse in={opens[group.id]} timeout=\"auto\" unmountOnExit>\n        <SideBarItemList links={[...group.links]} level={1} loopType={loopType} />\n      </Collapse>\n    </Box>\n  );\n}\n\ninterface TabLabelProps {\n  children: ReactNode;\n}\nfunction TabLabel({ children }: TabLabelProps) {\n  return <span style={{ margin: 0, display: 'flex', alignItems: 'center', gap: 4 }}>{children}</span>;\n}\n\ntype TabPanelHeaderProps = {\n  children: ReactNode;\n  tools?: ReactNode;\n};\n\nfunction TabPanelHeader({ children, tools = '' }: TabPanelHeaderProps) {\n  return (\n    <ListSubheader>\n      <Box display=\"flex\" alignItems=\"center\" justifyContent=\"space-between\">\n        <Typography\n          variant=\"h6\"\n          style={{ fontWeight: 400, fontSize: 14, height: 40, display: 'flex', alignItems: 'center' }}\n        >\n          {children}\n        </Typography>\n        {tools}\n      </Box>\n    </ListSubheader>\n  );\n}\n\nTabPanelHeader.defaultProps = {\n  tools: '',\n};\n\nexport function SideBar() {\n  const dispatch = useDispatch();\n  const linkState = useSelector((state: AppState) => state.linkState);\n  const navState = useSelector((state: AppState) => state.navState);\n  const headings = useSelector((state: AppState) => state.docState.headings);\n  const menu = useSelector((state: AppState) => state.settingState.menu);\n  const favorites = useSelector(favoriteSelector);\n  const open = navState.openTab;\n  const linkRef = useRef<boolean>(false);\n  const classes = useStyles({ open });\n  const { docKey } = useParams<{ docKey: string }>();\n\n  const handleChange = (event: ChangeEvent<{}>, newValue: NavTabType) => {\n    dispatch(toggleLinkTab(newValue));\n  };\n\n  const showTreeNode = useCallback(\n    (id: string) => {\n      const parentList: string[] = [];\n      let currentDepth = -1;\n\n      function searchPath(data: any[], depth = 0, callback: (item: any) => boolean): boolean {\n        let found = false;\n        for (let i = 0; i < data.length; i += 1) {\n          parentList[depth] = data[i].id;\n          if (callback(data[i])) {\n            currentDepth = depth;\n            found = true;\n            break;\n          }\n          if (data[i].links) {\n            if (searchPath(data[i].links, depth + 1, callback)) {\n              found = true;\n              break;\n            }\n          }\n        }\n\n        return found;\n      }\n\n      searchPath(linkState.groups, 0, (item) => {\n        return item.id === id;\n      });\n\n      if (currentDepth > -1) {\n        const newOpens: OpenState = {};\n\n        parentList.forEach((it) => {\n          newOpens[it] = true;\n        });\n\n        // update\n        dispatch(setLinkOpens(newOpens));\n      }\n    },\n    [linkState.groups, dispatch],\n  );\n\n  useEffect(() => {\n    if (linkRef.current) return;\n\n    if (docKey) {\n      const findItem = findOne(linkState.groups, (item) => item.fileLink === `/${docKey}`);\n      if (findItem) {\n        showTreeNode(findItem.id);\n        linkRef.current = true;\n      }\n    }\n  }, [docKey, showTreeNode, linkState.groups]);\n\n  return (\n    <Drawer variant=\"permanent\" className={classes.drawer} open={open}>\n      <TabContext value={navState.openTabValue}>\n        <Box>\n          <TabList\n            onChange={handleChange}\n            className={menu.theme === Theme.Dark ? classes.tabListDark : classes.tabListLight}\n            variant=\"scrollable\"\n            scrollButtons=\"auto\"\n          >\n            <Tab\n              label={\n                <TabLabel>\n                  <EventNote /> Notes\n                </TabLabel>\n              }\n              value=\"notes\"\n            />\n            <Tab\n              label={\n                <TabLabel>\n                  <ListAlt /> H1\n                </TabLabel>\n              }\n              value=\"toc\"\n            />\n          </TabList>\n        </Box>\n        <TabPanel value=\"notes\">\n          <TabPanelHeader>\n            <Star\n              fontSize=\"small\"\n              style={{\n                marginRight: 6,\n              }}\n            />{' '}\n            Favorites\n          </TabPanelHeader>\n          {favorites.map((it) => {\n            if (!it) {\n              return null;\n            }\n\n            if (it.type === 'link' && it.linkType === 'heading') {\n              return <HeadingItem key={it.id} item={it} level={0} loopType=\"favorite\" />;\n            }\n\n            return it.type === 'group' ? (\n              <GroupView key={it.id} group={it} loopType=\"favorite\" />\n            ) : (\n              <SidebarItem key={it.id} item={it} level={0} loopType=\"favorite\" />\n            );\n          })}\n          <Divider\n            style={{\n              margin: '8px 0',\n            }}\n          />\n          <TabPanelHeader\n            tools={\n              <Tooltip title=\"New group\">\n                <IconButton\n                  size=\"small\"\n                  onClick={() => {\n                    dispatch(newGroup('New Group'));\n                  }}\n                >\n                  <Add />\n                </IconButton>\n              </Tooltip>\n            }\n          >\n            <AccountTree\n              fontSize=\"small\"\n              style={{\n                marginRight: 6,\n              }}\n            />\n            Groups\n          </TabPanelHeader>\n          {linkState.groups.map((group) => {\n            return <GroupView key={group.id} group={group} loopType=\"links\" />;\n          })}\n          <div\n            style={{\n              position: 'absolute',\n              bottom: 0,\n              right: 0,\n              left: 0,\n              display: 'flex',\n              flexDirection: 'column',\n              alignItems: 'center',\n            }}\n          >\n            <Button\n              variant=\"outlined\"\n              disableRipple\n              style={{\n                width: '80%',\n                margin: '0 auto',\n              }}\n              onClick={() => {\n                dispatch(newGroup('New Group'));\n              }}\n            >\n              <Add fontSize=\"small\" />\n              Group\n            </Button>\n            <Box height={30} />\n          </div>\n        </TabPanel>\n        <TabPanel value=\"toc\">\n          {headings.map((it) => {\n            return <HeadingItem key={it.id} item={it} level={it.level || 0} loopType=\"links\" />;\n          })}\n        </TabPanel>\n      </TabContext>\n    </Drawer>\n  );\n}\n","import React, { useEffect } from 'react';\nimport { RouteComponentProps, useHistory } from 'react-router';\nimport { useLocation } from 'react-router-dom';\nimport ReactGA from 'react-ga4';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\n\nimport NavBar from 'components/NavBar';\nimport Editor from 'components/Editor';\nimport { AppState } from 'app/rootReducer';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { SideBar } from 'components/SideBar';\nimport { Snackbar } from '@material-ui/core';\nimport { hideMessage } from 'features/messageSlices';\nimport { Alert, SpeedDial, SpeedDialAction, SpeedDialIcon } from '@material-ui/lab';\nimport { EventNote, QuestionAnswer, RecordVoiceOver } from '@material-ui/icons';\nimport { recentFavoriteSelector, refreshStorage } from 'features/linkSlices';\n\ntype DocPageProps = {\n  docKey: string;\n};\n\ninterface LayoutProps {\n  open: boolean;\n}\n\nconst SIDEBAR_WIDTH = 300;\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n    },\n    sidebarArea: {\n      width: (props: LayoutProps) => (props.open ? SIDEBAR_WIDTH : 0),\n      '@media only screen and (max-width: 600px)': {\n        position: 'fixed',\n        left: 0,\n        top: 56,\n        bottom: 0,\n        zIndex: 1,\n      },\n      flexGrow: 0,\n      flex: 'none',\n      position: 'relative',\n      transition: 'width 225ms cubic-bezier(0, 0, 0.2, 1) 0ms',\n    },\n    layout: {\n      width: '100%',\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'row',\n    },\n    editorArea: {\n      width: '100%',\n      height: '100%',\n      display: 'flex',\n      flexDirection: 'column',\n    },\n  }),\n);\n\nfunction MessagePanel() {\n  const dispatch = useDispatch();\n  const message = useSelector((state: AppState) => state.messageState);\n  const handleCloseSnackbar = () => {\n    dispatch(hideMessage());\n  };\n  return (\n    <div>\n      {message.open && (\n        <Snackbar\n          open={message.open}\n          autoHideDuration={1000}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'left',\n          }}\n          onClose={handleCloseSnackbar}\n        >\n          <Alert onClose={handleCloseSnackbar} severity={message.type}>\n            {message.message}\n          </Alert>\n        </Snackbar>\n      )}\n    </div>\n  );\n}\n\nfunction SpeedDialPanel() {\n  const history = useHistory();\n  const favorites = useSelector(recentFavoriteSelector(3));\n  const [openSpeedDial, setOpenSpeedDial] = React.useState(false);\n\n  const handleSpeedDialOpen = () => {\n    setOpenSpeedDial(true);\n  };\n\n  const handleSpeedDialClose = () => {\n    setOpenSpeedDial(false);\n  };\n\n  return (\n    <SpeedDial\n      ariaLabel=\"SpeedDial\"\n      icon={<SpeedDialIcon />}\n      onClose={handleSpeedDialClose}\n      onOpen={handleSpeedDialOpen}\n      open={openSpeedDial}\n      direction=\"up\"\n      style={{\n        position: 'fixed',\n        bottom: 50,\n        right: 20,\n      }}\n    >\n      <SpeedDialAction\n        icon={<QuestionAnswer />}\n        tooltipTitle=\"Yorkie QnA\"\n        onClick={() => {\n          history.push('/qna');\n        }}\n      />\n      <SpeedDialAction\n        icon={<RecordVoiceOver />}\n        tooltipTitle=\"Yorkie Developer QnA\"\n        onClick={() => {\n          history.push('/developer-qna');\n        }}\n      />\n      {favorites.reverse().map((favorite) => {\n        return (\n          <SpeedDialAction\n            key={`${favorite.fileLink}${Math.random()}`}\n            icon={<EventNote />}\n            tooltipTitle={favorite.name}\n            onClick={() => {\n              if (favorite.fileLink) {\n                history.push(favorite.fileLink);\n              }\n            }}\n          />\n        );\n      })}\n    </SpeedDial>\n  );\n}\n\nexport default function DocPage(props: RouteComponentProps<DocPageProps>) {\n  const dispatch = useDispatch();\n  const openTab = useSelector((state: AppState) => state.navState.openTab);\n  const menu = useSelector((state: AppState) => state.settingState.menu);\n  const classes = useStyles({\n    open: openTab,\n  } as LayoutProps);\n  const location = useLocation();\n  const {\n    match: { params },\n  } = props;\n  const { docKey } = params;\n\n  useEffect(() => {\n    if (`${process.env.REACT_APP_GOOGLE_ANALYTICS}`) {\n      ReactGA.send('pageview');\n    }\n  }, [location]);\n\n  useEffect(() => {\n    window.addEventListener('storage', () => {\n      dispatch(refreshStorage());\n    });\n  }, [dispatch]);\n\n  return (\n    <div className={classes.root} data-theme={menu.theme}>\n      <NavBar />\n      <div className={classes.layout}>\n        <div className={classes.sidebarArea}>\n          <SideBar />\n        </div>\n        <div className={classes.editorArea}>\n          <Editor docKey={docKey} />\n        </div>\n      </div>\n      <MessagePanel />\n      <SpeedDialPanel />\n    </div>\n  );\n}\n","import React, { useMemo, useCallback } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Router, Route, Redirect, Switch } from 'react-router-dom';\nimport { createBrowserHistory } from 'history';\nimport * as Sentry from '@sentry/react';\nimport { Integrations } from '@sentry/tracing';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport { AppState } from 'app/rootReducer';\nimport { Theme } from 'features/settingSlices';\n\nimport DocPage from 'pages/DocPage';\n\nconst history = createBrowserHistory();\n\nif (process.env.NODE_ENV === 'production') {\n  Sentry.init({\n    dsn: `${process.env.REACT_APP_SENTRY_DSN}`,\n    release: `codepair@${process.env.REACT_APP_GIT_HASH}`,\n    integrations: [\n      new Integrations.BrowserTracing({\n        routingInstrumentation: Sentry.reactRouterV5Instrumentation(history),\n      }),\n    ],\n\n    // Set tracesSampleRate to 1.0 to capture 100%\n    // of transactions for performance monitoring.\n    // We recommend adjusting this value in production\n    tracesSampleRate: 1.0,\n  });\n}\n\nfunction App() {\n  const menu = useSelector((state: AppState) => state.settingState.menu);\n  const theme = useMemo(\n    () =>\n      createMuiTheme({\n        palette: {\n          type: menu.theme === Theme.Dark ? 'dark' : 'light',\n          primary: {\n            main: '#d8b01a',\n          },\n          secondary: {\n            main: '#e6b602',\n          },\n        },\n      }),\n    [menu],\n  );\n\n  const handleRender = useCallback(() => <Redirect to={`/${Math.random().toString(36).substring(7)}`} />, []);\n\n  return (\n    <ThemeProvider theme={theme}>\n      {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n      <CssBaseline />\n      <Router history={history}>\n        <Switch>\n          <Route path=\"/\" exact render={handleRender} />\n          <Route path=\"/:docKey\" exact component={DocPage} />\n        </Switch>\n      </Router>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import { combineReducers } from 'redux';\n\nimport docReducer from 'features/docSlices';\nimport peerReducer from 'features/peerSlices';\nimport settingReducer from 'features/settingSlices';\nimport boardReducer from 'features/boardSlices';\nimport linkReducer from 'features/linkSlices';\nimport messageReducer from 'features/messageSlices';\nimport navReducer from 'features/navSlices';\n\nconst rootReducer = combineReducers({\n  docState: docReducer,\n  peerState: peerReducer,\n  settingState: settingReducer,\n  boardState: boardReducer,\n  linkState: linkReducer,\n  messageState: messageReducer,\n  navState: navReducer,\n});\n\nexport type AppState = ReturnType<typeof rootReducer>;\n\nexport default rootReducer;\n","import { configureStore, getDefaultMiddleware } from '@reduxjs/toolkit';\n\nimport rootReducer from './rootReducer';\n\nconst store = configureStore({\n  reducer: rootReducer,\n  middleware: getDefaultMiddleware({\n    serializableCheck: {\n      ignoredActions: ['doc/attach/fulfilled', 'doc/activate/fulfilled'],\n      ignoredPaths: ['docState.client', 'docState.doc'],\n    },\n    immutableCheck: {\n      ignoredPaths: ['docState.client', 'docState.doc'],\n    },\n  }),\n});\n\nexport default store;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,\n    ),\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.',\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport ReactGA from 'react-ga4';\nimport App from 'app/App';\nimport store from 'app/store';\n\nimport * as serviceWorker from 'serviceWorker';\nimport './index.scss';\n\nconst trackingCode = `${process.env.REACT_APP_GOOGLE_ANALYTICS}`;\nif (trackingCode) {\n  ReactGA.initialize(trackingCode);\n}\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.querySelector('#root'),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}